<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="6733px" preserveAspectRatio="none" style="width:2399px;height:6733px;background:#FFFFFF;" version="1.1" viewBox="0 0 2399 6733" width="2399px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Courier" font-size="14" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="280" x="1055.5" y="27.9951">Potential&#160;PyTorch&#160;Tracing&#160;Interface</text><rect fill="none" height="667.7266" style="stroke:#000000;stroke-width:1.5;" width="1082" x="20" y="1143.9609"/><rect fill="none" height="1804.7656" style="stroke:#000000;stroke-width:1.5;" width="1732" x="160" y="1908.8203"/><rect fill="none" height="827.1875" style="stroke:#000000;stroke-width:1.5;" width="1259" x="216" y="2004.2188"/><rect fill="none" height="807.0469" style="stroke:#000000;stroke-width:1.5;" width="1634" x="248" y="2870.4063"/><rect fill="none" height="17.1328" style="stroke:#000000;stroke-width:1.5;" width="154" x="40" y="3810.7188"/><rect fill="none" height="2282.1797" style="stroke:#000000;stroke-width:1.5;" width="2372" x="10" y="4197.9766"/><rect fill="none" height="130.2656" style="stroke:#000000;stroke-width:1.5;" width="1998" x="20" y="4305.2422"/><rect fill="none" height="144.2656" style="stroke:#000000;stroke-width:1.5;" width="1998" x="20" y="4532.6406"/><rect fill="none" height="697.4531" style="stroke:#000000;stroke-width:1.5;" width="2352" x="20" y="4774.0391"/><rect fill="none" height="258.3281" style="stroke:#000000;stroke-width:1.5;" width="814" x="336" y="4827.3047"/><rect fill="none" height="120.7969" style="stroke:#000000;stroke-width:1.5;" width="910" x="1452" y="5286.5625"/><rect fill="none" height="190.7969" style="stroke:#000000;stroke-width:1.5;" width="1998" x="20" y="5739.9609"/><rect fill="none" height="273.9297" style="stroke:#000000;stroke-width:1.5;" width="2339" x="20" y="6199.2266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="53" x2="53" y1="73.5938" y2="6697.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="421" x2="421" y1="73.5938" y2="6697.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="835" x2="835" y1="73.5938" y2="6697.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1097" x2="1097" y1="73.5938" y2="6697.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1409" x2="1409" y1="73.5938" y2="6697.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1521" x2="1521" y1="73.5938" y2="6697.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1809" x2="1809" y1="73.5938" y2="6697.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1945" x2="1945" y1="73.5938" y2="6697.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2321" x2="2321" y1="73.5938" y2="6697.9531"/><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="30" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="32" x="37" y="62.292">User</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="30" y="6696.9531"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="32" x="37" y="6716.9482">User</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150" x="346" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="353" y="62.292">./bindings/python</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150" x="346" y="6696.9531"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="353" y="6716.9482">./bindings/python</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="808" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="40" x="815" y="62.292">torch</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="808" y="6696.9531"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="40" x="815" y="6716.9482">torch</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1054" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="1061" y="62.292">./lib/ffi</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1054" y="6696.9531"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="1061" y="6716.9482">./lib/ffi</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1366" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="1373" y="62.292">./lib/pcg</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1366" y="6696.9531"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="1373" y="6716.9482">./lib/pcg</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1462" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="104" x="1469" y="62.292">./lib/runtime</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1462" y="6696.9531"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="104" x="1469" y="6716.9482">./lib/runtime</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="1746" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="112" x="1753" y="62.292">./lib/compiler</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="1746" y="6696.9531"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="112" x="1753" y="6716.9482">./lib/compiler</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="1882" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="112" x="1889" y="62.292">RuntimeBacking</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="1882" y="6696.9531"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="112" x="1889" y="6716.9482">RuntimeBacking</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="2290" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="48" x="2297" y="62.292">legion</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="2290" y="6696.9531"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="48" x="2297" y="6716.9482">legion</text><rect fill="#F0F6FF" height="598" style="stroke:#181818;stroke-width:0.5;" width="2317" x="28" y="88.5938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="938.5" y="104.6606">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="264" x="938.5" y="119.7935">Example&#160;source&#160;code&#160;(adapted&#160;from</text><a href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" target="_top" title="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:actuate="onRequest" xlink:href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:show="new" xlink:title="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:type="simple"><text fill="#0000FF" font-family="Courier" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="160" x="1210.5" y="119.7935">the&#160;pytorch&#160;tutorial</text></a><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="1370.5" y="119.7935">)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="938.5" y="134.9263">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="256" x="946.5" y="150.0591">1&#160;import&#160;flexflow.torch&#160;as&#160;torch</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="256" x="946.5" y="165.1919">2&#160;import&#160;flexflow.torch.nn&#160;as&#160;nn</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="946.5" y="180.3247">3</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="264" x="946.5" y="195.4575">4&#160;class&#160;NeuralNetwork(nn.Module):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="184" x="946.5" y="210.5903">5&#160;&#160;&#160;def&#160;__init__(self):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="344" x="946.5" y="225.7231">6&#160;&#160;&#160;&#160;&#160;super(NeuralNetwork,&#160;self).__init__()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="264" x="946.5" y="240.856">7&#160;&#160;&#160;&#160;&#160;self.flatten&#160;=&#160;nn.Flatten()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="360" x="946.5" y="255.9888">8&#160;&#160;&#160;&#160;&#160;self.linear_relu_stack&#160;=&#160;nn.Sequential(</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="946.5" y="271.1216">9&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.Linear(28*28,&#160;512),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="938.5" y="286.2544">10&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.ReLU(),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="232" x="938.5" y="301.3872">11&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.Linear(512,&#160;512),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="938.5" y="316.52">12&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.ReLU(),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="938.5" y="331.6528">13&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.Linear(512,&#160;10),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="64" x="938.5" y="346.7856">14&#160;&#160;&#160;&#160;&#160;)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="938.5" y="361.9185">15</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="938.5" y="377.0513">16&#160;&#160;&#160;&#160;&#160;def&#160;forward(self,&#160;x):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="938.5" y="392.1841">17&#160;&#160;&#160;&#160;&#160;&#160;&#160;x&#160;=&#160;self.flatten(x)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="344" x="938.5" y="407.3169">18&#160;&#160;&#160;&#160;&#160;&#160;&#160;logits&#160;=&#160;self.linear_relu_stack(x)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="938.5" y="422.4497">19&#160;&#160;&#160;&#160;&#160;&#160;&#160;return&#160;logits</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="938.5" y="437.5825">20</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="192" x="938.5" y="452.7153">21&#160;def&#160;top_level_task():</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="938.5" y="467.8481">22&#160;&#160;&#160;model&#160;=&#160;NeuralNetwork()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="938.5" y="482.981">23</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="168" x="938.5" y="498.1138">24&#160;&#160;&#160;dataloader&#160;=&#160;...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="938.5" y="513.2466">25</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="408" x="938.5" y="528.3794">26&#160;&#160;&#160;for&#160;batch_id,&#160;(X,&#160;y)&#160;in&#160;enumerate(dataloader):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="248" x="938.5" y="543.5122">27&#160;&#160;&#160;&#160;&#160;pred&#160;=&#160;compiled_model(X)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="938.5" y="558.645">28&#160;&#160;&#160;&#160;&#160;loss&#160;=&#160;loss_fn(pred,&#160;y)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="938.5" y="573.7778">29&#160;&#160;&#160;&#160;&#160;loss.backward()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="184" x="938.5" y="588.9106">30&#160;&#160;&#160;&#160;&#160;optimizer.step()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="938.5" y="604.0435">31&#160;&#160;&#160;&#160;&#160;optimizer.zero_grad()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="938.5" y="619.1763">32</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="938.5" y="634.3091">33&#160;&#160;&#160;&#160;&#160;if&#160;batch_id&#160;%&#160;100&#160;==&#160;0:</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="496" x="938.5" y="649.4419">34&#160;&#160;&#160;&#160;&#160;&#160;&#160;loss,&#160;current&#160;=&#160;loss.item(),&#160;(batch_num&#160;+&#160;1)&#160;*&#160;len(X)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="496" x="938.5" y="664.5747">35&#160;&#160;&#160;&#160;&#160;&#160;&#160;print(f"loss:&#160;{loss:&gt;7f}&#160;[{current:&gt;5d}/{size:&gt;5d}]")</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="938.5" y="679.7075">&#160;</text><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="1045.8281" y2="1041.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="1045.8281" y2="1049.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="1045.8281" y2="1045.8281"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="240" x="60" y="707.8403">import&#160;flexflow.torch&#160;as&#160;torch</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="240" x="60" y="722.9731">import&#160;flexflow.torch.nn&#160;as&#160;nn</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="60" y="738.106">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="60" y="753.2388">#&#160;borrowed&#160;from</text><a href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" target="_top" title="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:actuate="onRequest" xlink:href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:show="new" xlink:title="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:type="simple"><text fill="#0000FF" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="160" x="188" y="753.2388">the&#160;pytorch&#160;tutorial</text></a><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="60" y="768.3716">class&#160;NeuralNetwork(nn.Module):</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="76" y="783.5044">def&#160;__init__(self):</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="296" x="92" y="798.6372">super(NeuralNetwork,&#160;self).__init__()</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216" x="92" y="813.77">self.flatten&#160;=&#160;nn.Flatten()</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312" x="92" y="828.9028">self.linear_relu_stack&#160;=&#160;nn.Sequential(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="108" y="844.0356">nn.Linear(28*28,&#160;512),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="108" y="859.1685">nn.ReLU(),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="160" x="108" y="874.3013">nn.Linear(512,&#160;512),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="108" y="889.4341">nn.ReLU(),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="108" y="904.5669">nn.Linear(512,&#160;10),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="92" y="919.6997">)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="60" y="934.8325">&#160;&#160;&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="92" y="949.9653">def&#160;forward(self,&#160;x):</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="108" y="965.0981">x&#160;=&#160;self.flatten(x)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="108" y="980.231">logits&#160;=&#160;self.linear_relu_stack(x)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="108" y="995.3638">return&#160;logits</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="60" y="1010.4966">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="60" y="1025.6294">def&#160;top_level_task():</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="76" y="1040.7622">model&#160;=&#160;NeuralNetwork()</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="1083.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="1099.895">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="1083.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="1099.895">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="1083.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="1099.895">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="1083.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="1099.895">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="1083.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="1099.895">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="1083.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="1099.895">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="1083.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="1099.895">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="1083.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="1099.895">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="1083.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="1099.895">legion</text><path d="M20,1143.9609 L89,1143.9609 L89,1151.0938 L79,1161.0938 L20,1161.0938 L20,1143.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="667.7266" style="stroke:#000000;stroke-width:1.5;" width="1082" x="20" y="1143.9609"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="35" y="1157.0278">alt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="28" x="104" y="1156.1714">[fx]</text><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="1242.7578" y2="1238.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="1242.7578" y2="1246.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="1242.7578" y2="1242.7578"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="60" y="1177.1606">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="76" y="1192.2935">compiled_model&#160;=&#160;model.compile(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="92" y="1207.4263">algorithm=...,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="92" y="1222.5591">optimizer=...</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="76" y="1237.6919">)</text><line style="stroke:#181818;stroke-width:1.0;" x1="833" x2="823" y1="1317.2891" y2="1313.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="833" x2="823" y1="1317.2891" y2="1321.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="834" y1="1317.2891" y2="1317.2891"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="428" y="1266.8247">from&#160;torch.fx&#160;import&#160;symbolic_trace</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="428" y="1281.9575">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="320" x="428" y="1297.0903">symbolic_traced&#160;&#160;=&#160;symbolic_trace(model)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="428" y="1312.2231">&#160;</text><line style="stroke:#181818;stroke-width:1.0;" x1="835" x2="877" y1="1346.4219" y2="1346.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="877" x2="877" y1="1346.4219" y2="1359.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="877" y1="1359.4219" y2="1359.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="846" y1="1359.4219" y2="1355.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="846" y1="1359.4219" y2="1363.4219"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="842" y="1341.356">model.forward(&lt;tracing&#160;tensor&gt;)</text><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="1371.4219" y2="1367.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="1371.4219" y2="1375.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="834" y1="1371.4219" y2="1371.4219"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="304" x="438" y="1384.4888">symbolic_traced&#160;:&#160;torch.fx.GraphModule</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="414" x="343" y="1396.5547"/><path d="M343,1396.5547 L412,1396.5547 L412,1403.5547 L402,1413.5547 L343,1413.5547 L343,1396.5547 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="356" y="1410.6216">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="399" x="347" y="1428.6934">compiled_model&#160;=&#160;compilation(symbolic_traced)&#160;#&#160;see&#160;below</text><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="1444.6563" y2="1440.6563"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="1444.6563" y2="1448.6563"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="1444.6563" y2="1444.6563"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="70" y="1457.7231">compiled_model:&#160;CompiledModel</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1102" y1="1470.7891" y2="1470.7891"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="56" x="25" y="1480.9995">[dynamo]</text><line style="stroke:#181818;stroke-width:1.0;" x1="833" x2="823" y1="1626.7891" y2="1622.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="833" x2="823" y1="1626.7891" y2="1630.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="834" y1="1626.7891" y2="1626.7891"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="60" y="1500.6606">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="76" y="1515.7935">compiled_model&#160;=&#160;torch.compile(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="92" y="1530.9263">model,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="92" y="1546.0591">backend='flexflow',</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="92" y="1561.1919">options=dict(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="108" y="1576.3247">algorithm=...,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="108" y="1591.4575">optimizer=...</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="92" y="1606.5903">)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="76" y="1621.7231">)</text><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="1638.7891" y2="1634.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="1638.7891" y2="1642.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="834" y1="1638.7891" y2="1638.7891"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="438" y="1651.856">def&#160;flexflow_compiler(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200" x="454" y="1666.9888">gm:&#160;torch.fx.GraphModule,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="454" y="1682.1216">example_inputs:&#160;List[torch.Tensor])</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="470" y="1697.2544">-&gt;&#160;CompiledModel</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="323" x="343" y="1709.3203"/><path d="M343,1709.3203 L412,1709.3203 L412,1716.3203 L402,1726.3203 L343,1726.3203 L343,1709.3203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="356" y="1723.3872">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="308" x="347" y="1741.459">compiled_model&#160;=&#160;compilation(gm)&#160;#&#160;see&#160;below</text><line style="stroke:#181818;stroke-width:1.0;" x1="833" x2="823" y1="1774.5547" y2="1770.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="833" x2="823" y1="1774.5547" y2="1778.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="834" y1="1774.5547" y2="1774.5547"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="428" y="1769.4888">compiled_model:&#160;CompiledModel</text><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="1786.5547" y2="1782.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="1786.5547" y2="1790.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="834" y1="1786.5547" y2="1786.5547"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="70" y="1799.6216">compiled_model:&#160;CompiledModel</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="1848.6875"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="1864.7544">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="1848.6875"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="1864.7544">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="1848.6875"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="1864.7544">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="1848.6875"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="1864.7544">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="1848.6875"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="1864.7544">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="1848.6875"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="1864.7544">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="1848.6875"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="1864.7544">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="1848.6875"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="1864.7544">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="1848.6875"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="1864.7544">legion</text><path d="M160,1908.8203 L301,1908.8203 L301,1915.9531 L291,1925.9531 L160,1925.9531 L160,1908.8203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1804.7656" style="stroke:#000000;stroke-width:1.5;" width="1732" x="160" y="1908.8203"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88" x="175" y="1921.8872">compilation</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="413" x="316" y="1921.0308">[def&#160;compilation(g:&#160;torch.fx.GraphModule)&#160;-&gt;&#160;CompiledModel]</text><polygon fill="#181818" points="409,1943.0859,419,1947.0859,409,1951.0859,413,1947.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="213" x2="415" y1="1947.0859" y2="1947.0859"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="220" y="1942.02">g:&#160;torch.fx.GraphModule</text><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="463" y1="1976.2188" y2="1976.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="463" x2="463" y1="1976.2188" y2="1989.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="463" y1="1989.2188" y2="1989.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="1989.2188" y2="1985.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="1989.2188" y2="1993.2188"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="400" x="428" y="1971.1528">ff_model&#160;=&#160;flexflow.torch.from_fx(symbolic_traced)</text><path d="M216,2004.2188 L445,2004.2188 L445,2011.3516 L435,2021.3516 L216,2021.3516 L216,2004.2188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="827.1875" style="stroke:#000000;stroke-width:1.5;" width="1259" x="216" y="2004.2188"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="231" y="2017.2856">flexflow.torch.from_fx</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="406" x="460" y="2016.4292">[def&#160;from_fx(g:&#160;torch.fx.GraphModule)&#160;-&gt;&#160;ComputationGraph]</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="2051.3516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="2067.4185">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="2051.3516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="2067.4185">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="2051.3516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="2067.4185">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="2051.3516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="2067.4185">./lib/pcg</text><polygon fill="#181818" points="409,2121.6172,419,2125.6172,409,2129.6172,413,2125.6172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="213" x2="415" y1="2125.6172" y2="2125.6172"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="220" y="2120.5513">g:&#160;torch.fx.GraphModule</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="2154.75" y2="2150.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="2154.75" y2="2158.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="2154.75" y2="2154.75"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="304" x="428" y="2149.6841">flexflow_computation_graph_create(...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="2191.75" y2="2187.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="2191.75" y2="2195.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="2191.75" y2="2191.75"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="438" y="2204.8169">typedef&#160;struct&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="486" y="2219.9497">ComputationGraphBuilder&#160;*ptr;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312" x="470" y="2235.0825">}&#160;flexflow_computation_graph_builder_t;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="2293.2813" y2="2289.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="2293.2813" y2="2297.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="2293.2813" y2="2293.2813"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="344" x="428" y="2288.2153">flexflow_computation_graph_add_op_flat(...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1407" x2="1397" y1="2322.4141" y2="2318.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="1407" x2="1397" y1="2322.4141" y2="2326.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1408" y1="2322.4141" y2="2322.4141"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="1104" y="2317.3481">ComputationGraphBuilder::flat(...);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="2359.4141" y2="2355.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="2359.4141" y2="2363.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1408" y1="2359.4141" y2="2359.4141"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="1114" y="2372.481">struct&#160;Tensor&#160;{&#160;...&#160;};</text><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="2388.5469" y2="2384.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="2388.5469" y2="2392.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="2388.5469" y2="2388.5469"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="438" y="2401.6138">typedef&#160;struct&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96" x="486" y="2416.7466">Tensor&#160;*ptr;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="160" x="470" y="2431.8794">}&#160;flexflow_tensor_t;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="2465.0781" y2="2461.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="2465.0781" y2="2469.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="2465.0781" y2="2465.0781"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="352" x="428" y="2460.0122">flexflow_computation_graph_add_op_dense(...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1407" x2="1397" y1="2494.2109" y2="2490.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1407" x2="1397" y1="2494.2109" y2="2498.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1408" y1="2494.2109" y2="2494.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="288" x="1104" y="2489.145">ComputationGraphBuilder::dense(...);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="2531.2109" y2="2527.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="2531.2109" y2="2535.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1408" y1="2531.2109" y2="2531.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="1114" y="2544.2778">Tensor</text><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="2560.3438" y2="2556.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="2560.3438" y2="2564.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="2560.3438" y2="2560.3438"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136" x="438" y="2573.4106">flexflow_tensor_t</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="2631.6094" y2="2627.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="2631.6094" y2="2635.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="2631.6094" y2="2631.6094"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="344" x="428" y="2626.5435">flexflow_computation_graph_add_op_relu(...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1407" x2="1397" y1="2660.7422" y2="2656.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="1407" x2="1397" y1="2660.7422" y2="2664.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1408" y1="2660.7422" y2="2660.7422"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="1104" y="2655.6763">ComputationGraphbuilder::relu(...);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="2697.7422" y2="2693.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="2697.7422" y2="2701.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1408" y1="2697.7422" y2="2697.7422"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="1114" y="2710.8091">Tensor</text><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="2726.875" y2="2722.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="2726.875" y2="2730.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="2726.875" y2="2726.875"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136" x="438" y="2739.9419">flexflow_tensor_t</text><path d="M364,2757.0078 L364,2782.0078 L1465,2782.0078 L1465,2767.0078 L1455,2757.0078 L364,2757.0078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1455,2757.0078 L1455,2767.0078 L1465,2767.0078 L1455,2757.0078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="874" y="2774.0747">...,&#160;etc.</text><polygon fill="#181818" points="256,2787.1406,246,2791.1406,256,2795.1406,252,2791.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="250" x2="420" y1="2791.1406" y2="2791.1406"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="262" y="2804.2075">comp_graph</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="270" y="2819.3403">:&#160;ComputationGraph</text><path d="M248,2870.4063 L397,2870.4063 L397,2877.5391 L387,2887.5391 L248,2887.5391 L248,2870.4063 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="807.0469" style="stroke:#000000;stroke-width:1.5;" width="1634" x="248" y="2870.4063"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96" x="263" y="2883.4731">optimization</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="455" x="412" y="2882.6167">[def&#160;optimization(comp_graph:&#160;ComputationGraph)&#160;-&gt;&#160;CompiledModel]</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="2917.5391"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="2933.606">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="2917.5391"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="2933.606">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="2917.5391"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="2933.606">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="2917.5391"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="2933.606">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="2917.5391"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="2933.606">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="2917.5391"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="2933.606">./lib/compiler</text><polygon fill="#181818" points="409,3002.9375,419,3006.9375,409,3010.9375,413,3006.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="245" x2="415" y1="3006.9375" y2="3006.9375"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="252" y="2986.7388">comp_graph</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="260" y="3001.8716">:&#160;ComputationGraph</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="3142" y2="3138"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="3142" y2="3146"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="3142" y2="3142"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="428" y="3031.0044">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="444" y="3046.1372">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="444" y="3061.27">flexflow_computation_graph_compile(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="460" y="3076.4028">flexflow_computation_graph_t,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="460" y="3091.5356">flexflow_optimizer_t,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264" x="460" y="3106.6685">flexflow_compilation_algorithm_t,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="304" x="460" y="3121.8013">flexflow_model_compilation_result&#160;*out</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="444" y="3136.9341">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="3216.5313" y2="3212.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="3216.5313" y2="3220.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="3216.5313" y2="3216.5313"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="256" x="1104" y="3166.0669">ModelCompilationResult&#160;optimize(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200" x="1136" y="3181.1997">ComputationGraph&#160;const&#160;&amp;,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1136" y="3196.3325">AlgorithmConfig&#160;const&#160;&amp;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1120" y="3211.4653">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1807" x2="1797" y1="3321.3281" y2="3317.3281"/><line style="stroke:#181818;stroke-width:1.0;" x1="1807" x2="1797" y1="3321.3281" y2="3325.3281"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1808" y1="3321.3281" y2="3321.3281"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="1528" y="3240.5981">SearchResult&#160;optimize(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200" x="1560" y="3255.731">ComputationGraph&#160;const&#160;&amp;,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1560" y="3270.8638">MachineSpecification&#160;const&#160;&amp;,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="1560" y="3285.9966">CostEstimator&#160;const&#160;&amp;,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1560" y="3301.1294">AlgorithmConfig&#160;const&#160;&amp;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1544" y="3316.2622">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1522" x2="1532" y1="3358.3281" y2="3354.3281"/><line style="stroke:#181818;stroke-width:1.0;" x1="1522" x2="1532" y1="3358.3281" y2="3362.3281"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1808" y1="3358.3281" y2="3358.3281"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="1538" y="3371.395">struct&#160;SearchResult&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1570" y="3386.5278">ParallelComputationGraph&#160;pcg;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1570" y="3401.6606">TensorMapping&#160;tensor_mapping;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="1570" y="3416.7935">SearchSolution&#160;solution;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1570" y="3431.9263">CostValues&#160;cost_values;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1554" y="3447.0591">};</text><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="3463.125" y2="3459.125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="3463.125" y2="3467.125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="3463.125" y2="3463.125"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="1114" y="3476.1919">struct&#160;ModelCompilationResult&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="1146" y="3491.3247">ComputationGraph&#160;computation_graph;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1146" y="3506.4575">ParallelComputationGraph&#160;pcg;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1146" y="3521.5903">TensorMapping&#160;tensor_mapping;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1130" y="3536.7231">};</text><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="3552.7891" y2="3548.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="3552.7891" y2="3556.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="3552.7891" y2="3552.7891"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="438" y="3565.856">typedef&#160;struct&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="224" x="470" y="3580.9888">ModelCompilationResult&#160;*ptr;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="454" y="3596.1216">}&#160;model_compilation_result_t;</text><polygon fill="#181818" points="280,3633.1875,270,3637.1875,280,3641.1875,276,3637.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="274" x2="420" y1="3637.1875" y2="3637.1875"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="286" y="3650.2544">compiled_model</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="294" y="3665.3872">:&#160;CompiledModel</text><polygon fill="#181818" points="168,3684.4531,158,3688.4531,168,3692.4531,164,3688.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="162" x2="420" y1="3688.4531" y2="3688.4531"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="240" x="174" y="3701.52">compiled_model&#160;:&#160;CompiledModel</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="3750.5859"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="3766.6528">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="3750.5859"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="3766.6528">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="3750.5859"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="3766.6528">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="3750.5859"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="3766.6528">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="3750.5859"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="3766.6528">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="3750.5859"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="3766.6528">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="3750.5859"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="3766.6528">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="3750.5859"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="3766.6528">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="3750.5859"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="3766.6528">legion</text><path d="M40,3810.7188 L189,3810.7188 L189,3817.8516 L179,3827.8516 L40,3827.8516 L40,3810.7188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="17.1328" style="stroke:#000000;stroke-width:1.5;" width="154" x="40" y="3810.7188"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="55" y="3823.7856">serialization</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="3864.8516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="3880.9185">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="3864.8516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="3880.9185">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="3864.8516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="3880.9185">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="3864.8516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="3880.9185">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="3864.8516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="3880.9185">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="3864.8516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="3880.9185">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="3864.8516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="3880.9185">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="3864.8516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="3880.9185">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="3864.8516"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="3880.9185">legion</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2392" x="0" y="3938.5508"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2392" y1="3938.5508" y2="3938.5508"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2392" y1="3941.5508" y2="3941.5508"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="142" x="1125" y="3927.9844"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="1131" y="3944.0513">Training&#160;Starts</text><rect fill="#F0F6FF" height="219" style="stroke:#181818;stroke-width:0.5;" width="2317" x="28" y="3966.1172"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="938.5" y="3982.1841">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="938.5" y="3997.3169">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="408" x="938.5" y="4012.4497">26&#160;&#160;&#160;for&#160;batch_id,&#160;(X,&#160;y)&#160;in&#160;enumerate(dataloader):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="248" x="938.5" y="4027.5825">27&#160;&#160;&#160;&#160;&#160;pred&#160;=&#160;compiled_model(X)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="938.5" y="4042.7153">28&#160;&#160;&#160;&#160;&#160;loss&#160;=&#160;loss_fn(pred,&#160;y)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="938.5" y="4057.8481">29&#160;&#160;&#160;&#160;&#160;loss.backward()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="184" x="938.5" y="4072.981">30&#160;&#160;&#160;&#160;&#160;optimizer.step()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="938.5" y="4088.1138">31&#160;&#160;&#160;&#160;&#160;optimizer.zero_grad()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="938.5" y="4103.2466">32</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="938.5" y="4118.3794">33&#160;&#160;&#160;&#160;&#160;if&#160;batch_id&#160;%&#160;100&#160;==&#160;0:</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="496" x="938.5" y="4133.5122">34&#160;&#160;&#160;&#160;&#160;&#160;&#160;loss,&#160;current&#160;=&#160;loss.item(),&#160;(batch_num&#160;+&#160;1)&#160;*&#160;len(X)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="496" x="938.5" y="4148.645">35&#160;&#160;&#160;&#160;&#160;&#160;&#160;print(f"loss:&#160;{loss:&gt;7f}&#160;[{current:&gt;5d}/{size:&gt;5d}]")</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="938.5" y="4163.7778">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="938.5" y="4178.9106">&#160;</text><path d="M10,4197.9766 L87,4197.9766 L87,4205.1094 L77,4215.1094 L10,4215.1094 L10,4197.9766 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2282.1797" style="stroke:#000000;stroke-width:1.5;" width="2372" x="10" y="4197.9766"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="25" y="4211.0435">loop</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="102" y="4210.187">[training&#160;loop]</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="4245.1094"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="4261.1763">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="4245.1094"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="4261.1763">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="4245.1094"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="4261.1763">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="4245.1094"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="4261.1763">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="4245.1094"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="4261.1763">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="4245.1094"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="4261.1763">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="4245.1094"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="4261.1763">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="4245.1094"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="4261.1763">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="4245.1094"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="4261.1763">legion</text><path d="M20,4305.2422 L89,4305.2422 L89,4312.375 L79,4322.375 L20,4322.375 L20,4305.2422 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="130.2656" style="stroke:#000000;stroke-width:1.5;" width="1998" x="20" y="4305.2422"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="35" y="4318.3091">opt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="175" x="104" y="4317.4526">[reading&#160;tensor&#160;elements]</text><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="4343.5078" y2="4339.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="4343.5078" y2="4347.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="4343.5078" y2="4343.5078"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="60" y="4338.4419">get_tensor</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="4357.5078" y2="4353.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="4357.5078" y2="4361.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="4357.5078" y2="4357.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="4371.5078" y2="4367.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="4371.5078" y2="4375.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="4371.5078" y2="4371.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="4385.5078" y2="4381.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="4385.5078" y2="4389.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1944" y1="4385.5078" y2="4385.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="4397.5078" y2="4393.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="4397.5078" y2="4401.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="4397.5078" y2="4397.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="4411.5078" y2="4407.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="4411.5078" y2="4415.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="4411.5078" y2="4411.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="4425.5078" y2="4421.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="4425.5078" y2="4429.5078"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="4425.5078" y2="4425.5078"/><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="4472.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="4488.5747">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="4472.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="4488.5747">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="4472.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="4488.5747">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="4472.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="4488.5747">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="4472.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="4488.5747">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="4472.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="4488.5747">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="4472.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="4488.5747">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="4472.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="4488.5747">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="4472.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="4488.5747">legion</text><path d="M20,4532.6406 L89,4532.6406 L89,4539.7734 L79,4549.7734 L20,4549.7734 L20,4532.6406 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="144.2656" style="stroke:#000000;stroke-width:1.5;" width="1998" x="20" y="4532.6406"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="35" y="4545.7075">opt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="196" x="104" y="4544.8511">[writing&#160;to&#160;tensor&#160;elements]</text><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="4570.9063" y2="4566.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="4570.9063" y2="4574.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="4570.9063" y2="4570.9063"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="60" y="4565.8403">set_tensor</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="4584.9063" y2="4580.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="4584.9063" y2="4588.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="4584.9063" y2="4584.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="4598.9063" y2="4594.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="4598.9063" y2="4602.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="4598.9063" y2="4598.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="4612.9063" y2="4608.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="4612.9063" y2="4616.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1944" y1="4612.9063" y2="4612.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1522" x2="1532" y1="4624.9063" y2="4620.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1522" x2="1532" y1="4624.9063" y2="4628.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1944" y1="4624.9063" y2="4624.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="4638.9063" y2="4634.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="4638.9063" y2="4642.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="4638.9063" y2="4638.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="4652.9063" y2="4648.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="4652.9063" y2="4656.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="4652.9063" y2="4652.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="4666.9063" y2="4662.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="4666.9063" y2="4670.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="4666.9063" y2="4666.9063"/><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="4713.9063"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="4729.9731">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="4713.9063"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="4729.9731">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="4713.9063"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="4729.9731">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="4713.9063"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="4729.9731">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="4713.9063"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="4729.9731">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="4713.9063"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="4729.9731">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="4713.9063"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="4729.9731">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="4713.9063"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="4729.9731">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="4713.9063"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="4729.9731">legion</text><path d="M20,4774.0391 L89,4774.0391 L89,4781.1719 L79,4791.1719 L20,4791.1719 L20,4774.0391 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="697.4531" style="stroke:#000000;stroke-width:1.5;" width="2352" x="20" y="4774.0391"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="35" y="4787.106">fwd</text><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="4812.3047" y2="4808.3047"/><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="4812.3047" y2="4816.3047"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="4812.3047" y2="4812.3047"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="224" x="60" y="4807.2388">pred&#160;=&#160;compiled_model(batch)</text><path d="M336,4827.3047 L405,4827.3047 L405,4834.4375 L395,4844.4375 L336,4844.4375 L336,4827.3047 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="258.3281" style="stroke:#000000;stroke-width:1.5;" width="814" x="336" y="4827.3047"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="351" y="4840.3716">opt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="420" y="4839.5151">[if&#160;first&#160;iteration]</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="4926.1016" y2="4922.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="4926.1016" y2="4930.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="4926.1016" y2="4926.1016"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="428" y="4860.5044">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="428" y="4875.6372">flexflow_start_training(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="288" x="444" y="4890.77">flexflow_model_compilation_result_t,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="320" x="444" y="4905.9028">flexflow_model_compilation_result_t&#160;*out</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="428" y="4921.0356">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="4963.1016" y2="4959.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="4963.1016" y2="4967.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="4963.1016" y2="4963.1016"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="438" y="4976.1685">typedef&#160;struct&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216" x="454" y="4991.3013">ModelTrainingInstance&#160;*ptr;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="296" x="438" y="5006.4341">}&#160;flexflow_model_training_instance_t;</text><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="463" y1="5064.6328" y2="5064.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="463" x2="463" y1="5064.6328" y2="5077.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="463" y1="5077.6328" y2="5077.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="5077.6328" y2="5073.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="5077.6328" y2="5081.6328"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="428" y="5059.5669">model.training_instance&#160;=&#160;...</text><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="5096.6328" y2="5092.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="5096.6328" y2="5100.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="5096.6328" y2="5096.6328"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="70" y="5109.6997">pred:&#160;TensorFuture</text><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="5167.8984" y2="5163.8984"/><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="5167.8984" y2="5171.8984"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="5167.8984" y2="5167.8984"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216" x="60" y="5162.8325">loss&#160;=&#160;loss_fn(pred,&#160;label)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="5242.4297" y2="5238.4297"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="5242.4297" y2="5246.4297"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="5242.4297" y2="5242.4297"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="428" y="5191.9653">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="328" x="428" y="5207.0981">flexflow_model_training_instance_forward(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="444" y="5222.231">flexflow_model_training_instance_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="428" y="5237.3638">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="5271.5625" y2="5267.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="5271.5625" y2="5275.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="5271.5625" y2="5271.5625"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312" x="1104" y="5266.4966">forward(ModelTrainingInstance&#160;const&#160;&amp;);</text><path d="M1452,5286.5625 L1529,5286.5625 L1529,5293.6953 L1519,5303.6953 L1452,5303.6953 L1452,5286.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="120.7969" style="stroke:#000000;stroke-width:1.5;" width="910" x="1452" y="5286.5625"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="1467" y="5299.6294">loop</text><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="5324.8281" y2="5320.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="5324.8281" y2="5328.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1944" y1="5324.8281" y2="5324.8281"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="1528" y="5319.7622">execute(OpTaskInvocation&#160;const&#160;&amp;);</text><line style="stroke:#181818;stroke-width:1.0;" x1="2319" x2="2309" y1="5399.3594" y2="5395.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="2319" x2="2309" y1="5399.3594" y2="5403.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="1945" x2="2320" y1="5399.3594" y2="5399.3594"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1952" y="5348.895">IndexLauncher&#160;launcher;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1952" y="5364.0278">...</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="352" x="1952" y="5379.1606">runtime-&gt;execute_index_space(ctx,&#160;launcher);</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1984" y="5394.2935">end</text><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="5418.3594" y2="5414.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="5418.3594" y2="5422.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="5418.3594" y2="5418.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="5432.3594" y2="5428.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="5432.3594" y2="5436.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="5432.3594" y2="5432.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="5446.3594" y2="5442.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="64" y1="5446.3594" y2="5450.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="5446.3594" y2="5446.3594"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="70" y="5459.4263">loss:&#160;LossTensor</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="5508.4922"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="5524.5591">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="5508.4922"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="5524.5591">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="5508.4922"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="5524.5591">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="5508.4922"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="5524.5591">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="5508.4922"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="5524.5591">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="5508.4922"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="5524.5591">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="5508.4922"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="5524.5591">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="5508.4922"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="5524.5591">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="5508.4922"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="5524.5591">legion</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="2328" x="27" y="5561.625"/><path d="M27,5561.625 L96,5561.625 L96,5568.625 L86,5578.625 L27,5578.625 L27,5561.625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="40" y="5575.6919">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="238" x="1072" y="5593.7637">[optional]&#160;reading&#160;tensor&#160;elements</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="2328" x="27" y="5605.7266"/><path d="M27,5605.7266 L96,5605.7266 L96,5612.7266 L86,5622.7266 L27,5622.7266 L27,5605.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="40" y="5619.7935">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="259" x="1061.5" y="5637.8652">[optional]&#160;writing&#160;to&#160;tensor&#160;elements</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="5679.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="5695.895">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="5679.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="5695.895">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="5679.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="5695.895">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="5679.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="5695.895">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="5679.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="5695.895">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="5679.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="5695.895">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="5679.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="5695.895">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="5679.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="5695.895">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="5679.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="5695.895">legion</text><path d="M20,5739.9609 L89,5739.9609 L89,5747.0938 L79,5757.0938 L20,5757.0938 L20,5739.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="190.7969" style="stroke:#000000;stroke-width:1.5;" width="1998" x="20" y="5739.9609"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="35" y="5753.0278">bwd</text><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="5778.2266" y2="5774.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="5778.2266" y2="5782.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="5778.2266" y2="5778.2266"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="60" y="5773.1606">loss.backward()</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="5852.7578" y2="5848.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="5852.7578" y2="5856.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="5852.7578" y2="5852.7578"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="428" y="5802.2935">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="336" x="428" y="5817.4263">flexflow_model_training_instance_backward(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="444" y="5832.5591">flexflow_model_training_instance_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="428" y="5847.6919">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="5866.7578" y2="5862.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="5866.7578" y2="5870.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="5866.7578" y2="5866.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="5880.7578" y2="5876.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="5880.7578" y2="5884.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1944" y1="5880.7578" y2="5880.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1522" x2="1532" y1="5892.7578" y2="5888.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1522" x2="1532" y1="5892.7578" y2="5896.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1944" y1="5892.7578" y2="5892.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="5906.7578" y2="5902.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="5906.7578" y2="5910.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="5906.7578" y2="5906.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="5920.7578" y2="5916.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="5920.7578" y2="5924.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="5920.7578" y2="5920.7578"/><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="5967.7578"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="5983.8247">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="5967.7578"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="5983.8247">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="5967.7578"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="5983.8247">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="5967.7578"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="5983.8247">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="5967.7578"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="5983.8247">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="5967.7578"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="5983.8247">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="5967.7578"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="5983.8247">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="5967.7578"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="5983.8247">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="5967.7578"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="5983.8247">legion</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="2328" x="27" y="6020.8906"/><path d="M27,6020.8906 L96,6020.8906 L96,6027.8906 L86,6037.8906 L27,6037.8906 L27,6020.8906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="40" y="6034.9575">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="238" x="1072" y="6053.0293">[optional]&#160;reading&#160;tensor&#160;elements</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="2328" x="27" y="6064.9922"/><path d="M27,6064.9922 L96,6064.9922 L96,6071.9922 L86,6081.9922 L27,6081.9922 L27,6064.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="40" y="6079.0591">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="259" x="1061.5" y="6097.1309">[optional]&#160;writing&#160;to&#160;tensor&#160;elements</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="6139.0938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="6155.1606">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="6139.0938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="6155.1606">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="6139.0938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="6155.1606">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="6139.0938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="6155.1606">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="6139.0938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="6155.1606">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="6139.0938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="6155.1606">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="6139.0938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="6155.1606">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="6139.0938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="6155.1606">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="6139.0938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="6155.1606">legion</text><path d="M20,6199.2266 L113,6199.2266 L113,6206.3594 L103,6216.3594 L20,6216.3594 L20,6199.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="273.9297" style="stroke:#000000;stroke-width:1.5;" width="2339" x="20" y="6199.2266"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="35" y="6212.2935">update</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="6246.3594"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="6262.4263">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="6246.3594"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="6262.4263">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="6246.3594"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="6262.4263">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="6246.3594"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="6262.4263">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="6246.3594"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="6262.4263">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="6246.3594"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="6262.4263">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="6246.3594"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="6262.4263">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="6246.3594"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="6262.4263">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="6246.3594"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="6262.4263">legion</text><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="6320.625" y2="6316.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="409" y1="6320.625" y2="6324.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="420" y1="6320.625" y2="6320.625"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="60" y="6315.5591">optimizer.step()</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="6395.1563" y2="6391.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="6395.1563" y2="6399.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="6395.1563" y2="6395.1563"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="428" y="6344.6919">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="320" x="428" y="6359.8247">flexflow_model_training_instance_update(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="444" y="6374.9575">flexflow_model_training_instance_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="428" y="6390.0903">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="6409.1563" y2="6405.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1519" x2="1509" y1="6409.1563" y2="6413.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="6409.1563" y2="6409.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="6423.1563" y2="6419.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1943" x2="1933" y1="6423.1563" y2="6427.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1944" y1="6423.1563" y2="6423.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1522" x2="1532" y1="6435.1563" y2="6431.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1522" x2="1532" y1="6435.1563" y2="6439.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1521" x2="1944" y1="6435.1563" y2="6435.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="6449.1563" y2="6445.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1098" x2="1108" y1="6449.1563" y2="6453.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1097" x2="1520" y1="6449.1563" y2="6449.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="6463.1563" y2="6459.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="432" y1="6463.1563" y2="6467.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="6463.1563" y2="6463.1563"/><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="33" y="6517.1563"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="37" y="6533.2231">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="349" y="6517.1563"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="353" y="6533.2231">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="811" y="6517.1563"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="815" y="6533.2231">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1057" y="6517.1563"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1061" y="6533.2231">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1369" y="6517.1563"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1373" y="6533.2231">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1465" y="6517.1563"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1469" y="6533.2231">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1749" y="6517.1563"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1753" y="6533.2231">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1885" y="6517.1563"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1889" y="6533.2231">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2293" y="6517.1563"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2297" y="6533.2231">legion</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2392" x="0" y="6590.8555"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2392" y1="6590.8555" y2="6590.8555"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2392" y1="6593.8555" y2="6593.8555"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="134" x="1129" y="6580.2891"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="1135" y="6596.356">Training&#160;Stops</text><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="6679.9531" y2="6675.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="1095" x2="1085" y1="6679.9531" y2="6683.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="1096" y1="6679.9531" y2="6679.9531"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="428" y="6629.4888">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="428" y="6644.6216">flexflow_stop_training(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="444" y="6659.7544">flexflow_model_training_instance_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="428" y="6674.8872">);</text><!--SRC=[xHbhRziuyhj-1RVjTUMSuyHEqsJTEeScs0G5qbwGns61D11eYRA5ofAEf1hdqknllncIUbaFEzkz0muu5usbuRndE3EaPI13HXndQ-iYbYoI0Gt9nSDrpDqvkURK3Q8P-HX9ndtgigqjnx6idrwbWd4o8IzkuFi5l2SFSXv721diJ8F80oAneu6uB1KtM5KF2F7zG6E7mNG7NXGJTrR0u0LXF0MD5go06m2kkV4Y2KAjY5xC82NAO-f-HHC0vx82GPoGpGAjjdvIMb0k0pT8Q2IFpqxYC5RyNvwgZnRhiH9yz_GjmYq1J86MBeZ7V9g6yZIEv6SAkf_4AGyORyQuaW_W_caSUgLrodbytxhAcKZYIB1FJ0WwOySiZEy_80MHF6KbHC7-cRB8pH0_XC4i8Y7pPGFE9VCPnuVDi5gLAxiF73tZSHfvsbteA_XdMIKSSaEe82zKGhseB5peXIo9oalNUiaaKtdbLA-eX2h3pmmpJAeo_5B3ywGghvtejIAdoel75S8yfSeevnebooph9p-DN8dvzch6f1DuIxkSR3sBa9y2drI0P3B9d8FhWC6PJ7b4TX6RXO8rKnYlLMc6tJJQdLMIKJS9-hbAiBT6BmX0bU1DDq4McIhHVZTH7h8grTkDH6MnhD8UTDEQ85Tf3XKD54FVmgyi_9092OzTvgMSaLUSBQ1UEYMEmdub9BnEJE3xv1LGJof2ld__Zimr8gOIrA8YgnHKvHDIrfO1rYD_rUaGnZDIC0a4ALZsIKQCOFES9sb1z7v2TidhrpaAEIAxnX787Lk4UkCHz1SIVuE2VKCQokoOA7iBfpMA6gw86cfHEoNk5otSzQPOmt-qmdzKvt_Tmbzje3NizrROxzNPdxQmXyssXlcR5UPlwipFsdpZpjOmtrzXlbzdVjd2tEoiDGBUhWXuMnTmqY8Ws_1h91oiI3YeIpZkDi4KXpLo3bVa79QsmxdQn3MvvorommmzbuTR7r_o6cB1HtEYBe-58CM4Obc_BkaYWIujO0Pn6S4LObEF9f9vnEVnWjpUpgLCn7W7vpNCu47CPpioXMSO1SNE53I88iPtfbG4hjY94t14y2-AfSp9q0PpkGY9d3DYc91ivUwkPrcmQuD54dD9_90jVPXN1XeBEgJPDQDcZ44K8L84BjWZ5cIu6r8myJDBEGq_CtaVywzs50q-nLuQijxOWZmbE5-HtnqdY0BfEBPWeOyhRz7fHAG9utQ5GPyeb4510W4xqDYmCF13Ac4qXY8Aaaxr2w8S5YXX437A7Sx2r85SSBzgv2irD-5CRLla5w8_03zNwFReS6jqs2Vxmr6lRmrtY_LBTdvZ8snOem7ad6BKGB7NJ37SnSKtQgbd3VVLWpNKFa5_-J6_fznJtkgJ9JXiU61OOVieEy9U0eT3imX97KYHOTJye70poqrZr2JMQ9TOew4IBkF42Tat5ZgIYgys21-XRGj8rn1OLyFTiqQG2oEqnQEIXZ7rr25WC1XOetrOGQF073Abqft37kmJ-xS-UUYH88AUbYuOfvBP1IsAqxOc7BR5X9XwuZbA0Vita7XeZ1LeAduvVcGZEZAsHh_aouCfMAqysRFsT4ZDbc5y82HB43vSWSF_s9bngeXqLAqz7KaeBvaTv2yGnbsSE7R7rjwRF012z8cRSXZCfL5k44YsW7GWjgO5ex7ZzyWMJFOH6hItRyWJ7aJIzbyWsPWygg-Z0_-9t3uQdkEZVUzfvr60fkhn3aOG2oeGmQ83nUTc- -ZeOjozmR-4tTlxI_Wb_Fqb72Rm7FDVAqrVmZNbv4lON4mGlcafCRZjXQI4iBwCQEIs8b9QDGMXZbyKa8sniNZe9QEi_jjODZ8M3KKZMrfVCZBCIi7076ai5eZTLYginWaRu3I4P5oQv4KErKqFhDJtm82DusauWzoHyyK4getnIRwD4OOWx7Za0XXVZrKUwzprbrcB4myBE3K7hYCvTHcQLOLu17rJ0TbA6V0BSBvMd8t9Wom0xwMvh05VYvWVAIMkbNMhtCUvHeCpJfEvpdR4v-1UCqEh4QNc4mrGEynUOTiZBo6WZ4pnFWB9eKHaZhWPrxcDoObv_uIl5fwkYFSGqKKCL3VAoCQuQEMhSL5h9XvOWF74z7DMQtuk1IgEnCGBN9blfAQ8DiJKf7x9gohxZGGdcq0LszcYsSEAEzCJ6PI799LGSSy38MyrzhMAt9t9_ksZ5GSzDpwpHLT888Ewus4CnT2jGLHSs_OPtW0bPRt8BNgkecYpkter5znPokg_RM-3_yciFO-rYO13V3_tpKhhmQtf-CjQ6cjwhNOpYROWer-dVIgLbMhfpjBfrUYi_Dgcdz-K6FHD3DOcduwhEMc4usoHp1sNCvny8ANrYSGGuf72F9uQjn4Y7nA6PWh9KrUInsndh9fqd0OXpbzRYUJlDD9JbmvJZU_8TrPT_7eJgESvKF-ngMWxIegVZJiK78zpcYR9PreoDc9jiDwCv177IlBqRdC76S9cV-ZYh8n_hiaUaBBdsbmGTHYjDLwniARoZuGBc_k6gayprNEQFqtpqXLHdvmP8C40zmcJxi10Yj7MxBxtsziNkbfggo2guvhUbY7LL4PLNKNASwck7MM8NJ2kSssfWUlhH-aErCeBo3eJh2oacBUv6ndCvE352goXjbJwSGUYxA-WvBsslbJg4axUgEjegi9Na3aJAGnuMt6gzDOvXFbn2Kcd_7XIO5zgv4mFOyAgTy1xaP3ajH7-8LFd98xyO9Qj5j8kGTe9IBk2wTQT_o4PdwWxX-duAc5ku0UkJg0goaaivAy2c59e3SzLqMJfYV6BgMGLXKrPkw0mLOVQQnM5eK-PAgVtuYUQ9CKKwYpqgq7HdA_YC5MM2FFmhZ3b7pHCcG1DXNI-gMUr-9HxzBJGioMCZwskNSd4Tt-UQKzvVc5lQEuCBUhcVUA9jAMnwPKcMgLoLCna-NukpTDOYngHIVC4jsQ44mmFpQPehHdw9XFyxHXEmE2kAxmQXTFUfEEQKbtT_F_QvZz-ROD-BbtTX76S49a52jzQcujg8s0v746eL-m2maAs0672z4fzd2RuMvD6g4mAfJvzcRtWfZuklrJGBiOb1ZVZuWZJhUGzb3sbPDojfzX0JzAawF6g2J-gjJblt9lvGUlNdDSgDymaXSP2gla1XyeEsSFrxYmRK-_ZEKJ_Qf4bW5tfyEt5gByXdkc-ZVERzb9JeLGLAIiU7w5XqSXbMPLyMfMRwGx7QOtPVgw0SEiRangDkJkk370wSXY0RCeyJQNwjQN2MiUfiRw458xTlO9RPoJQhCbkTnfStc1wuMoTkXbriq_DE92HgErVJdNbZoLpKwYwVq-kgVZwCVeMLwUG8hYu8yx77oEFBSzf6hbp6BD3ym2HKzSevbUqxIF35bG7T4SaUCFbocK_f-YPpelnA4N5x3IhjD5AqTAry1p-5kU2jHillrAvwPDpnUnMtnFHyAwZs1c-dTITLMZ3YZ3L5Q78itAZiduWit8spqkjl7QRScZbjT0gXwS8plzw0D849WxMZQcZKviNVYGyMkmV2yupe_ECIIvEz22tGMU1KtzNOscrmlet]--></g></svg>