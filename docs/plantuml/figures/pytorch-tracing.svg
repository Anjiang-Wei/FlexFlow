<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="7909px" preserveAspectRatio="none" style="width:2420px;height:7909px;background:#FFFFFF;" version="1.1" viewBox="0 0 2420 7909" width="2420px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Courier" font-size="14" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="280" x="1066" y="27.9951">Potential&#160;PyTorch&#160;Tracing&#160;Interface</text><rect fill="none" height="667.7266" style="stroke:#000000;stroke-width:1.5;" width="1082" x="31" y="1370.9531"/><rect fill="none" height="1802.7656" style="stroke:#000000;stroke-width:1.5;" width="1732" x="171" y="2135.8125"/><rect fill="none" height="825.1875" style="stroke:#000000;stroke-width:1.5;" width="1259" x="227" y="2231.2109"/><rect fill="none" height="807.0469" style="stroke:#000000;stroke-width:1.5;" width="1634" x="259" y="3095.3984"/><rect fill="none" height="3591.6797" style="stroke:#000000;stroke-width:1.5;" width="2394" x="9" y="4035.7109"/><rect fill="none" height="17.1328" style="stroke:#000000;stroke-width:1.5;" width="170" x="51" y="4162.375"/><rect fill="none" height="1476.8438" style="stroke:#000000;stroke-width:1.5;" width="2374" x="19" y="4549.6328"/><rect fill="none" height="130.2656" style="stroke:#000000;stroke-width:1.5;" width="1998" x="31" y="4656.8984"/><rect fill="none" height="144.2656" style="stroke:#000000;stroke-width:1.5;" width="1998" x="31" y="4884.2969"/><rect fill="none" height="778.25" style="stroke:#000000;stroke-width:1.5;" width="2354" x="29" y="5125.6953"/><rect fill="none" height="258.3281" style="stroke:#000000;stroke-width:1.5;" width="814" x="347" y="5287.7578"/><rect fill="none" height="149.9297" style="stroke:#000000;stroke-width:1.5;" width="910" x="1463" y="5747.0156"/><rect fill="none" height="464.7891" style="stroke:#000000;stroke-width:1.5;" width="2354" x="29" y="6294.9453"/><rect fill="none" height="149.9297" style="stroke:#000000;stroke-width:1.5;" width="910" x="1463" y="6545.5391"/><rect fill="none" height="592.1875" style="stroke:#000000;stroke-width:1.5;" width="2354" x="29" y="7028.2031"/><rect fill="none" height="149.9297" style="stroke:#000000;stroke-width:1.5;" width="910" x="1463" y="7406.1953"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="64" x2="64" y1="73.5938" y2="7874.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="432" x2="432" y1="73.5938" y2="7874.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="846" x2="846" y1="73.5938" y2="7874.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1108" x2="1108" y1="73.5938" y2="7874.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1420" x2="1420" y1="73.5938" y2="7874.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1532" x2="1532" y1="73.5938" y2="7874.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1820" x2="1820" y1="73.5938" y2="7874.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1956" x2="1956" y1="73.5938" y2="7874.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2332" x2="2332" y1="73.5938" y2="7874.3203"/><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="41" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="32" x="48" y="62.292">User</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="41" y="7873.3203"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="32" x="48" y="7893.3154">User</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150" x="357" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="364" y="62.292">./bindings/python</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150" x="357" y="7873.3203"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="136" x="364" y="7893.3154">./bindings/python</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="819" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="40" x="826" y="62.292">torch</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="819" y="7873.3203"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="40" x="826" y="7893.3154">torch</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1065" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="1072" y="62.292">./lib/ffi</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1065" y="7873.3203"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="1072" y="7893.3154">./lib/ffi</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1377" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="1384" y="62.292">./lib/pcg</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1377" y="7873.3203"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="72" x="1384" y="7893.3154">./lib/pcg</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1473" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="104" x="1480" y="62.292">./lib/runtime</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1473" y="7873.3203"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="104" x="1480" y="7893.3154">./lib/runtime</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="1757" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="112" x="1764" y="62.292">./lib/compiler</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="1757" y="7873.3203"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="112" x="1764" y="7893.3154">./lib/compiler</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="1893" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="112" x="1900" y="62.292">RuntimeBacking</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="1893" y="7873.3203"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="112" x="1900" y="7893.3154">RuntimeBacking</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="2301" y="42.2969"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="48" x="2308" y="62.292">legion</text><rect fill="#F0F0F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="2301" y="7873.3203"/><text fill="#000000" font-family="Courier" font-size="14" lengthAdjust="spacing" textLength="48" x="2308" y="7893.3154">legion</text><rect fill="#F0F6FF" height="825" style="stroke:#181818;stroke-width:0.5;" width="2317" x="39" y="88.5938"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="949.5" y="104.6606">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="264" x="949.5" y="119.7935">Example&#160;source&#160;code&#160;(adapted&#160;from</text><a href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" target="_top" title="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:actuate="onRequest" xlink:href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:show="new" xlink:title="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:type="simple"><text fill="#0000FF" font-family="Courier" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="160" x="1221.5" y="119.7935">the&#160;pytorch&#160;tutorial</text></a><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="1381.5" y="119.7935">)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="949.5" y="134.9263">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="256" x="957.5" y="150.0591">1&#160;import&#160;flexflow.torch&#160;as&#160;torch</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="256" x="957.5" y="165.1919">2&#160;import&#160;flexflow.torch.nn&#160;as&#160;nn</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="957.5" y="180.3247">3</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="264" x="957.5" y="195.4575">4&#160;class&#160;NeuralNetwork(nn.Module):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="184" x="957.5" y="210.5903">5&#160;&#160;&#160;def&#160;__init__(self):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="344" x="957.5" y="225.7231">6&#160;&#160;&#160;&#160;&#160;super(NeuralNetwork,&#160;self).__init__()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="264" x="957.5" y="240.856">7&#160;&#160;&#160;&#160;&#160;self.flatten&#160;=&#160;nn.Flatten()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="360" x="957.5" y="255.9888">8&#160;&#160;&#160;&#160;&#160;self.linear_relu_stack&#160;=&#160;nn.Sequential(</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="957.5" y="271.1216">9&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.Linear(28*28,&#160;512),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="949.5" y="286.2544">10&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.ReLU(),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="232" x="949.5" y="301.3872">11&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.Linear(512,&#160;512),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="152" x="949.5" y="316.52">12&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.ReLU(),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="949.5" y="331.6528">13&#160;&#160;&#160;&#160;&#160;&#160;&#160;nn.Linear(512,&#160;10),</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="64" x="949.5" y="346.7856">14&#160;&#160;&#160;&#160;&#160;)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="949.5" y="361.9185">15</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="949.5" y="377.0513">16&#160;&#160;&#160;&#160;&#160;def&#160;forward(self,&#160;x):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="949.5" y="392.1841">17&#160;&#160;&#160;&#160;&#160;&#160;&#160;x&#160;=&#160;self.flatten(x)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="344" x="949.5" y="407.3169">18&#160;&#160;&#160;&#160;&#160;&#160;&#160;logits&#160;=&#160;self.linear_relu_stack(x)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="949.5" y="422.4497">19&#160;&#160;&#160;&#160;&#160;&#160;&#160;return&#160;logits</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="949.5" y="437.5825">20</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="192" x="949.5" y="452.7153">21&#160;def&#160;top_level_task():</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="949.5" y="467.8481">22&#160;&#160;&#160;model&#160;=&#160;NeuralNetwork()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="949.5" y="482.981">23</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="168" x="949.5" y="498.1138">24&#160;&#160;&#160;dataloader&#160;=&#160;...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="949.5" y="513.2466">25</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="368" x="949.5" y="528.3794">26&#160;&#160;&#160;if&#160;tracing_mechanism&#160;==&#160;'symbolic_trace':</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="304" x="949.5" y="543.5122">27&#160;&#160;&#160;&#160;&#160;compiled_model&#160;=&#160;model.compile(</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="184" x="949.5" y="558.645">28&#160;&#160;&#160;&#160;&#160;&#160;&#160;algorithm=...,</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="949.5" y="573.7778">29&#160;&#160;&#160;&#160;&#160;&#160;&#160;optimizer=...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="64" x="949.5" y="588.9106">30&#160;&#160;&#160;&#160;&#160;)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="320" x="949.5" y="604.0435">31&#160;&#160;&#160;elif&#160;tracing_mechanism&#160;==&#160;'dynamo':</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="304" x="949.5" y="619.1763">32&#160;&#160;&#160;&#160;&#160;compiled_model&#160;=&#160;torch.compile(</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="120" x="949.5" y="634.3091">33&#160;&#160;&#160;&#160;&#160;&#160;&#160;model,</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="949.5" y="649.4419">34&#160;&#160;&#160;&#160;&#160;&#160;&#160;backend='flexflow',</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="949.5" y="664.5747">35&#160;&#160;&#160;&#160;&#160;&#160;&#160;options=dict(</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="200" x="949.5" y="679.7075">36&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;algorithm=...,</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="200" x="949.5" y="694.8403">37&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;optimizer=...,</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="80" x="949.5" y="709.9731">38&#160;&#160;&#160;&#160;&#160;&#160;&#160;)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="64" x="949.5" y="725.106">39&#160;&#160;&#160;&#160;&#160;)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="949.5" y="740.2388">40</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="408" x="949.5" y="755.3716">41&#160;&#160;&#160;for&#160;batch_id,&#160;(X,&#160;y)&#160;in&#160;enumerate(dataloader):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="248" x="949.5" y="770.5044">42&#160;&#160;&#160;&#160;&#160;pred&#160;=&#160;compiled_model(X)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="949.5" y="785.6372">43&#160;&#160;&#160;&#160;&#160;loss&#160;=&#160;loss_fn(pred,&#160;y)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="949.5" y="800.77">44&#160;&#160;&#160;&#160;&#160;loss.backward()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="184" x="949.5" y="815.9028">45&#160;&#160;&#160;&#160;&#160;optimizer.step()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="949.5" y="831.0356">46&#160;&#160;&#160;&#160;&#160;optimizer.zero_grad()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="949.5" y="846.1685">47</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="949.5" y="861.3013">48&#160;&#160;&#160;&#160;&#160;if&#160;batch_id&#160;%&#160;100&#160;==&#160;0:</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="496" x="949.5" y="876.4341">49&#160;&#160;&#160;&#160;&#160;&#160;&#160;loss,&#160;current&#160;=&#160;loss.item(),&#160;(batch_num&#160;+&#160;1)&#160;*&#160;len(X)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="496" x="949.5" y="891.5669">50&#160;&#160;&#160;&#160;&#160;&#160;&#160;print(f"loss:&#160;{loss:&gt;7f}&#160;[{current:&gt;5d}/{size:&gt;5d}]")</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="949.5" y="906.6997">&#160;</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="1272.8203" y2="1268.8203"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="1272.8203" y2="1276.8203"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="1272.8203" y2="1272.8203"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="240" x="71" y="934.8325">import&#160;flexflow.torch&#160;as&#160;torch</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="240" x="71" y="949.9653">import&#160;flexflow.torch.nn&#160;as&#160;nn</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="71" y="965.0981">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="71" y="980.231">#&#160;borrowed&#160;from</text><a href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" target="_top" title="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:actuate="onRequest" xlink:href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:show="new" xlink:title="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html" xlink:type="simple"><text fill="#0000FF" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="160" x="199" y="980.231">the&#160;pytorch&#160;tutorial</text></a><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="71" y="995.3638">class&#160;NeuralNetwork(nn.Module):</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="87" y="1010.4966">def&#160;__init__(self):</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="296" x="103" y="1025.6294">super(NeuralNetwork,&#160;self).__init__()</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216" x="103" y="1040.7622">self.flatten&#160;=&#160;nn.Flatten()</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312" x="103" y="1055.895">self.linear_relu_stack&#160;=&#160;nn.Sequential(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="119" y="1071.0278">nn.Linear(28*28,&#160;512),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="119" y="1086.1606">nn.ReLU(),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="160" x="119" y="1101.2935">nn.Linear(512,&#160;512),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="119" y="1116.4263">nn.ReLU(),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="119" y="1131.5591">nn.Linear(512,&#160;10),</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="103" y="1146.6919">)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="71" y="1161.8247">&#160;&#160;&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="103" y="1176.9575">def&#160;forward(self,&#160;x):</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="119" y="1192.0903">x&#160;=&#160;self.flatten(x)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="119" y="1207.2231">logits&#160;=&#160;self.linear_relu_stack(x)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="119" y="1222.356">return&#160;logits</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="71" y="1237.4888">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="71" y="1252.6216">def&#160;top_level_task():</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="87" y="1267.7544">model&#160;=&#160;NeuralNetwork()</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="1310.8203"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="1326.8872">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="1310.8203"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="1326.8872">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="1310.8203"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="1326.8872">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="1310.8203"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="1326.8872">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="1310.8203"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="1326.8872">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="1310.8203"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="1326.8872">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="1310.8203"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="1326.8872">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="1310.8203"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="1326.8872">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="1310.8203"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="1326.8872">legion</text><path d="M31,1370.9531 L100,1370.9531 L100,1378.0859 L90,1388.0859 L31,1388.0859 L31,1370.9531 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="667.7266" style="stroke:#000000;stroke-width:1.5;" width="1082" x="31" y="1370.9531"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="46" y="1384.02">alt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="28" x="115" y="1383.1636">[fx]</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="1469.75" y2="1465.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="1469.75" y2="1473.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="1469.75" y2="1469.75"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="71" y="1404.1528">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="87" y="1419.2856">compiled_model&#160;=&#160;model.compile(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="103" y="1434.4185">algorithm=...,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="103" y="1449.5513">optimizer=...</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="87" y="1464.6841">)</text><line style="stroke:#181818;stroke-width:1.0;" x1="844" x2="834" y1="1544.2813" y2="1540.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="844" x2="834" y1="1544.2813" y2="1548.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="845" y1="1544.2813" y2="1544.2813"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="439" y="1493.8169">from&#160;torch.fx&#160;import&#160;symbolic_trace</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="439" y="1508.9497">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="320" x="439" y="1524.0825">symbolic_traced&#160;&#160;=&#160;symbolic_trace(model)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="439" y="1539.2153">&#160;</text><line style="stroke:#181818;stroke-width:1.0;" x1="846" x2="888" y1="1573.4141" y2="1573.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="888" x2="888" y1="1573.4141" y2="1586.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="847" x2="888" y1="1586.4141" y2="1586.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="847" x2="857" y1="1586.4141" y2="1582.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="847" x2="857" y1="1586.4141" y2="1590.4141"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="853" y="1568.3481">model.forward(&lt;tracing&#160;tensor&gt;)</text><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="1598.4141" y2="1594.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="1598.4141" y2="1602.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="845" y1="1598.4141" y2="1598.4141"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="304" x="449" y="1611.481">symbolic_traced&#160;:&#160;torch.fx.GraphModule</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="414" x="354" y="1623.5469"/><path d="M354,1623.5469 L423,1623.5469 L423,1630.5469 L413,1640.5469 L354,1640.5469 L354,1623.5469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="367" y="1637.6138">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="399" x="358" y="1655.6855">compiled_model&#160;=&#160;compilation(symbolic_traced)&#160;#&#160;see&#160;below</text><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="1671.6484" y2="1667.6484"/><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="1671.6484" y2="1675.6484"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="1671.6484" y2="1671.6484"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="81" y="1684.7153">compiled_model:&#160;CompiledModel</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="31" x2="1113" y1="1697.7813" y2="1697.7813"/><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="56" x="36" y="1707.9917">[dynamo]</text><line style="stroke:#181818;stroke-width:1.0;" x1="844" x2="834" y1="1853.7813" y2="1849.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="844" x2="834" y1="1853.7813" y2="1857.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="845" y1="1853.7813" y2="1853.7813"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="71" y="1727.6528">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="87" y="1742.7856">compiled_model&#160;=&#160;torch.compile(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="103" y="1757.9185">model,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="103" y="1773.0513">backend='flexflow',</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="103" y="1788.1841">options=dict(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="119" y="1803.3169">algorithm=...,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="119" y="1818.4497">optimizer=...</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="103" y="1833.5825">)</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="87" y="1848.7153">)</text><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="1865.7813" y2="1861.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="1865.7813" y2="1869.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="845" y1="1865.7813" y2="1865.7813"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="449" y="1878.8481">def&#160;flexflow_compiler(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200" x="465" y="1893.981">gm:&#160;torch.fx.GraphModule,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="465" y="1909.1138">example_inputs:&#160;List[torch.Tensor])</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="481" y="1924.2466">-&gt;&#160;CompiledModel</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="323" x="354" y="1936.3125"/><path d="M354,1936.3125 L423,1936.3125 L423,1943.3125 L413,1953.3125 L354,1953.3125 L354,1936.3125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="367" y="1950.3794">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="308" x="358" y="1968.4512">compiled_model&#160;=&#160;compilation(gm)&#160;#&#160;see&#160;below</text><line style="stroke:#181818;stroke-width:1.0;" x1="844" x2="834" y1="2001.5469" y2="1997.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="844" x2="834" y1="2001.5469" y2="2005.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="845" y1="2001.5469" y2="2001.5469"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="439" y="1996.481">compiled_model:&#160;CompiledModel</text><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="2013.5469" y2="2009.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="2013.5469" y2="2017.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="845" y1="2013.5469" y2="2013.5469"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="81" y="2026.6138">compiled_model:&#160;CompiledModel</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="2075.6797"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="2091.7466">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="2075.6797"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="2091.7466">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="2075.6797"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="2091.7466">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="2075.6797"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="2091.7466">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="2075.6797"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="2091.7466">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="2075.6797"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="2091.7466">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="2075.6797"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="2091.7466">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="2075.6797"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="2091.7466">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="2075.6797"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="2091.7466">legion</text><path d="M171,2135.8125 L312,2135.8125 L312,2142.9453 L302,2152.9453 L171,2152.9453 L171,2135.8125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1802.7656" style="stroke:#000000;stroke-width:1.5;" width="1732" x="171" y="2135.8125"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88" x="186" y="2148.8794">compilation</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="413" x="327" y="2148.0229">[def&#160;compilation(g:&#160;torch.fx.GraphModule)&#160;-&gt;&#160;CompiledModel]</text><polygon fill="#181818" points="420,2170.0781,430,2174.0781,420,2178.0781,424,2174.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="224" x2="426" y1="2174.0781" y2="2174.0781"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="231" y="2169.0122">g:&#160;torch.fx.GraphModule</text><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="474" y1="2203.2109" y2="2203.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="474" x2="474" y1="2203.2109" y2="2216.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="474" y1="2216.2109" y2="2216.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2216.2109" y2="2212.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2216.2109" y2="2220.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="400" x="439" y="2198.145">ff_model&#160;=&#160;flexflow.torch.from_fx(symbolic_traced)</text><path d="M227,2231.2109 L456,2231.2109 L456,2238.3438 L446,2248.3438 L227,2248.3438 L227,2231.2109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="825.1875" style="stroke:#000000;stroke-width:1.5;" width="1259" x="227" y="2231.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="242" y="2244.2778">flexflow.torch.from_fx</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="406" x="471" y="2243.4214">[def&#160;from_fx(g:&#160;torch.fx.GraphModule)&#160;-&gt;&#160;ComputationGraph]</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="2278.3438"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="2294.4106">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="2278.3438"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="2294.4106">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="2278.3438"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="2294.4106">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="2278.3438"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="2294.4106">./lib/pcg</text><polygon fill="#181818" points="420,2348.6094,430,2352.6094,420,2356.6094,424,2352.6094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="224" x2="426" y1="2352.6094" y2="2352.6094"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="231" y="2347.5435">g:&#160;torch.fx.GraphModule</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="2381.7422" y2="2377.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="2381.7422" y2="2385.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="2381.7422" y2="2381.7422"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="304" x="439" y="2376.6763">flexflow_computation_graph_create(...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2418.7422" y2="2414.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2418.7422" y2="2422.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="2418.7422" y2="2418.7422"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="449" y="2431.8091">typedef&#160;struct&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="497" y="2446.9419">ComputationGraphBuilder&#160;*ptr;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312" x="481" y="2462.0747">}&#160;flexflow_computation_graph_builder_t;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="2520.2734" y2="2516.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="2520.2734" y2="2524.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="2520.2734" y2="2520.2734"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="344" x="439" y="2515.2075">flexflow_computation_graph_add_op_flat(...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1418" x2="1408" y1="2549.4063" y2="2545.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1418" x2="1408" y1="2549.4063" y2="2553.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1419" y1="2549.4063" y2="2549.4063"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="1115" y="2544.3403">ComputationGraphBuilder::flat(...);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="2586.4063" y2="2582.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="2586.4063" y2="2590.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1419" y1="2586.4063" y2="2586.4063"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="1125" y="2599.4731">struct&#160;Tensor&#160;{&#160;...&#160;};</text><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2615.5391" y2="2611.5391"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2615.5391" y2="2619.5391"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="2615.5391" y2="2615.5391"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="449" y="2628.606">typedef&#160;struct&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96" x="497" y="2643.7388">Tensor&#160;*ptr;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="160" x="481" y="2658.8716">}&#160;flexflow_tensor_t;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="2692.0703" y2="2688.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="2692.0703" y2="2696.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="2692.0703" y2="2692.0703"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="352" x="439" y="2687.0044">flexflow_computation_graph_add_op_dense(...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1418" x2="1408" y1="2721.2031" y2="2717.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="1418" x2="1408" y1="2721.2031" y2="2725.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1419" y1="2721.2031" y2="2721.2031"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="288" x="1115" y="2716.1372">ComputationGraphBuilder::dense(...);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="2758.2031" y2="2754.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="2758.2031" y2="2762.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1419" y1="2758.2031" y2="2758.2031"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="1125" y="2771.27">Tensor</text><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2787.3359" y2="2783.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2787.3359" y2="2791.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="2787.3359" y2="2787.3359"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136" x="449" y="2800.4028">flexflow_tensor_t</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="2858.6016" y2="2854.6016"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="2858.6016" y2="2862.6016"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="2858.6016" y2="2858.6016"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="344" x="439" y="2853.5356">flexflow_computation_graph_add_op_relu(...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1418" x2="1408" y1="2887.7344" y2="2883.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1418" x2="1408" y1="2887.7344" y2="2891.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1419" y1="2887.7344" y2="2887.7344"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="1115" y="2882.6685">ComputationGraphbuilder::relu(...);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="2924.7344" y2="2920.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="2924.7344" y2="2928.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1419" y1="2924.7344" y2="2924.7344"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="1125" y="2937.8013">Tensor</text><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2953.8672" y2="2949.8672"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="2953.8672" y2="2957.8672"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="2953.8672" y2="2953.8672"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136" x="449" y="2966.9341">flexflow_tensor_t</text><rect fill="#FEFFDD" height="23" style="stroke:#181818;stroke-width:0.5;" width="1101" x="375" y="2984"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="889.5" y="3000.0669">...,&#160;etc.</text><polygon fill="#181818" points="267,3012.1328,257,3016.1328,267,3020.1328,263,3016.1328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261" x2="431" y1="3016.1328" y2="3016.1328"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="273" y="3029.1997">comp_graph</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="281" y="3044.3325">:&#160;ComputationGraph</text><path d="M259,3095.3984 L408,3095.3984 L408,3102.5313 L398,3112.5313 L259,3112.5313 L259,3095.3984 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="807.0469" style="stroke:#000000;stroke-width:1.5;" width="1634" x="259" y="3095.3984"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96" x="274" y="3108.4653">optimization</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="455" x="423" y="3107.6089">[def&#160;optimization(comp_graph:&#160;ComputationGraph)&#160;-&gt;&#160;CompiledModel]</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="3142.5313"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="3158.5981">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="3142.5313"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="3158.5981">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="3142.5313"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="3158.5981">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="3142.5313"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="3158.5981">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="3142.5313"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="3158.5981">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="3142.5313"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="3158.5981">./lib/compiler</text><polygon fill="#181818" points="420,3227.9297,430,3231.9297,420,3235.9297,424,3231.9297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="256" x2="426" y1="3231.9297" y2="3231.9297"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="263" y="3211.731">comp_graph</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="271" y="3226.8638">:&#160;ComputationGraph</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="3366.9922" y2="3362.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="3366.9922" y2="3370.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="3366.9922" y2="3366.9922"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="439" y="3255.9966">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="455" y="3271.1294">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="455" y="3286.2622">flexflow_computation_graph_compile(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="471" y="3301.395">flexflow_computation_graph_t,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="471" y="3316.5278">flexflow_optimizer_t,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264" x="471" y="3331.6606">flexflow_compilation_algorithm_t,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="304" x="471" y="3346.7935">flexflow_model_compilation_result&#160;*out</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="455" y="3361.9263">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="3441.5234" y2="3437.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="3441.5234" y2="3445.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1531" y1="3441.5234" y2="3441.5234"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="256" x="1115" y="3391.0591">ModelCompilationResult&#160;optimize(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200" x="1147" y="3406.1919">ComputationGraph&#160;const&#160;&amp;,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1147" y="3421.3247">AlgorithmConfig&#160;const&#160;&amp;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1131" y="3436.4575">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1818" x2="1808" y1="3546.3203" y2="3542.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="1818" x2="1808" y1="3546.3203" y2="3550.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1819" y1="3546.3203" y2="3546.3203"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="1539" y="3465.5903">SearchResult&#160;optimize(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200" x="1571" y="3480.7231">ComputationGraph&#160;const&#160;&amp;,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1571" y="3495.856">MachineSpecification&#160;const&#160;&amp;,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="1571" y="3510.9888">CostEstimator&#160;const&#160;&amp;,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1571" y="3526.1216">AlgorithmConfig&#160;const&#160;&amp;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1555" y="3541.2544">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="3583.3203" y2="3579.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="3583.3203" y2="3587.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1819" y1="3583.3203" y2="3583.3203"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="1549" y="3596.3872">struct&#160;SearchResult&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1581" y="3611.52">ParallelComputationGraph&#160;pcg;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1581" y="3626.6528">TensorMapping&#160;tensor_mapping;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="1581" y="3641.7856">SearchSolution&#160;solution;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1581" y="3656.9185">CostValues&#160;cost_values;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1565" y="3672.0513">};</text><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="3688.1172" y2="3684.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="3688.1172" y2="3692.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1531" y1="3688.1172" y2="3688.1172"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="1125" y="3701.1841">struct&#160;ModelCompilationResult&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="1157" y="3716.3169">ComputationGraph&#160;computation_graph;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1157" y="3731.4497">ParallelComputationGraph&#160;pcg;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="1157" y="3746.5825">TensorMapping&#160;tensor_mapping;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1141" y="3761.7153">};</text><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="3777.7813" y2="3773.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="3777.7813" y2="3781.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="3777.7813" y2="3777.7813"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="449" y="3790.8481">typedef&#160;struct&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="224" x="481" y="3805.981">ModelCompilationResult&#160;*ptr;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="465" y="3821.1138">}&#160;model_compilation_result_t;</text><polygon fill="#181818" points="291,3858.1797,281,3862.1797,291,3866.1797,287,3862.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="285" x2="431" y1="3862.1797" y2="3862.1797"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="297" y="3875.2466">compiled_model</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="305" y="3890.3794">:&#160;CompiledModel</text><polygon fill="#181818" points="179,3909.4453,169,3913.4453,179,3917.4453,175,3913.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="173" x2="431" y1="3913.4453" y2="3913.4453"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="240" x="185" y="3926.5122">compiled_model&#160;:&#160;CompiledModel</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="3975.5781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="3991.645">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="3975.5781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="3991.645">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="3975.5781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="3991.645">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="3975.5781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="3991.645">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="3975.5781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="3991.645">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="3975.5781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="3991.645">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="3975.5781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="3991.645">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="3975.5781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="3991.645">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="3975.5781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="3991.645">legion</text><path d="M9,4035.7109 L158,4035.7109 L158,4042.8438 L148,4052.8438 L9,4052.8438 L9,4035.7109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="3591.6797" style="stroke:#000000;stroke-width:1.5;" width="2394" x="9" y="4035.7109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="24" y="4048.7778">serialization</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="4073.9766" y2="4069.9766"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="4073.9766" y2="4077.9766"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="4073.9766" y2="4073.9766"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="296" x="71" y="4068.9106">model_json&#160;=&#160;compiled_model.as_json()</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="4118.2422" y2="4114.2422"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="4118.2422" y2="4122.2422"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="4118.2422" y2="4118.2422"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="296" x="71" y="4098.0435">with&#160;open('compiled.json',&#160;'w')&#160;as&#160;f:</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="87" y="4113.1763">compiled_model.dump(f)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="4147.375" y2="4143.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="4147.375" y2="4151.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="4147.375" y2="4147.375"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="439" y="4142.3091">end</text><path d="M51,4162.375 L216,4162.375 L216,4169.5078 L206,4179.5078 L51,4179.5078 L51,4162.375 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="17.1328" style="stroke:#000000;stroke-width:1.5;" width="170" x="51" y="4162.375"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="66" y="4175.4419">deserialization</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="4216.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="4232.5747">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="4216.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="4232.5747">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="4216.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="4232.5747">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="4216.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="4232.5747">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="4216.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="4232.5747">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="4216.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="4232.5747">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="4216.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="4232.5747">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="4216.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="4232.5747">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="4216.5078"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="4232.5747">legion</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2413" x="0" y="4290.207"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2413" y1="4290.207" y2="4290.207"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2413" y1="4293.207" y2="4293.207"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="142" x="1135.5" y="4279.6406"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="1141.5" y="4295.7075">Training&#160;Starts</text><rect fill="#F0F6FF" height="219" style="stroke:#181818;stroke-width:0.5;" width="2317" x="39" y="4317.7734"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="949.5" y="4333.8403">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="949.5" y="4348.9731">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="408" x="949.5" y="4364.106">41&#160;&#160;&#160;for&#160;batch_id,&#160;(X,&#160;y)&#160;in&#160;enumerate(dataloader):</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="248" x="949.5" y="4379.2388">42&#160;&#160;&#160;&#160;&#160;pred&#160;=&#160;compiled_model(X)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="949.5" y="4394.3716">43&#160;&#160;&#160;&#160;&#160;loss&#160;=&#160;loss_fn(pred,&#160;y)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="949.5" y="4409.5044">44&#160;&#160;&#160;&#160;&#160;loss.backward()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="184" x="949.5" y="4424.6372">45&#160;&#160;&#160;&#160;&#160;optimizer.step()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="949.5" y="4439.77">46&#160;&#160;&#160;&#160;&#160;optimizer.zero_grad()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="16" x="949.5" y="4454.9028">47</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="949.5" y="4470.0356">48&#160;&#160;&#160;&#160;&#160;if&#160;batch_id&#160;%&#160;100&#160;==&#160;0:</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="496" x="949.5" y="4485.1685">49&#160;&#160;&#160;&#160;&#160;&#160;&#160;loss,&#160;current&#160;=&#160;loss.item(),&#160;(batch_num&#160;+&#160;1)&#160;*&#160;len(X)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="496" x="949.5" y="4500.3013">50&#160;&#160;&#160;&#160;&#160;&#160;&#160;print(f"loss:&#160;{loss:&gt;7f}&#160;[{current:&gt;5d}/{size:&gt;5d}]")</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="949.5" y="4515.4341">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="949.5" y="4530.5669">&#160;</text><path d="M19,4549.6328 L96,4549.6328 L96,4556.7656 L86,4566.7656 L19,4566.7656 L19,4549.6328 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1476.8438" style="stroke:#000000;stroke-width:1.5;" width="2374" x="19" y="4549.6328"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="34" y="4562.6997">loop</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="111" y="4561.8433">[training&#160;loop]</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="4596.7656"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="4612.8325">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="4596.7656"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="4612.8325">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="4596.7656"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="4612.8325">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="4596.7656"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="4612.8325">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="4596.7656"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="4612.8325">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="4596.7656"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="4612.8325">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="4596.7656"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="4612.8325">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="4596.7656"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="4612.8325">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="4596.7656"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="4612.8325">legion</text><path d="M31,4656.8984 L100,4656.8984 L100,4664.0313 L90,4674.0313 L31,4674.0313 L31,4656.8984 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="130.2656" style="stroke:#000000;stroke-width:1.5;" width="1998" x="31" y="4656.8984"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="46" y="4669.9653">opt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="175" x="115" y="4669.1089">[reading&#160;tensor&#160;elements]</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="4695.1641" y2="4691.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="4695.1641" y2="4699.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="4695.1641" y2="4695.1641"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="71" y="4690.0981">get_tensor</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="4709.1641" y2="4705.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="4709.1641" y2="4713.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="4709.1641" y2="4709.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="4723.1641" y2="4719.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="4723.1641" y2="4727.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1531" y1="4723.1641" y2="4723.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="4737.1641" y2="4733.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="4737.1641" y2="4741.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1955" y1="4737.1641" y2="4737.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="4749.1641" y2="4745.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="4749.1641" y2="4753.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1531" y1="4749.1641" y2="4749.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="4763.1641" y2="4759.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="4763.1641" y2="4767.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="4763.1641" y2="4763.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="4777.1641" y2="4773.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="4777.1641" y2="4781.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="4777.1641" y2="4777.1641"/><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="4824.1641"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="4840.231">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="4824.1641"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="4840.231">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="4824.1641"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="4840.231">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="4824.1641"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="4840.231">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="4824.1641"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="4840.231">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="4824.1641"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="4840.231">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="4824.1641"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="4840.231">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="4824.1641"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="4840.231">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="4824.1641"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="4840.231">legion</text><path d="M31,4884.2969 L100,4884.2969 L100,4891.4297 L90,4901.4297 L31,4901.4297 L31,4884.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="144.2656" style="stroke:#000000;stroke-width:1.5;" width="1998" x="31" y="4884.2969"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="46" y="4897.3638">opt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="196" x="115" y="4896.5073">[writing&#160;to&#160;tensor&#160;elements]</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="4922.5625" y2="4918.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="4922.5625" y2="4926.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="4922.5625" y2="4922.5625"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="80" x="71" y="4917.4966">set_tensor</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="4936.5625" y2="4932.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="4936.5625" y2="4940.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="4936.5625" y2="4936.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="4950.5625" y2="4946.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="4950.5625" y2="4954.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1531" y1="4950.5625" y2="4950.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="4964.5625" y2="4960.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="4964.5625" y2="4968.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1955" y1="4964.5625" y2="4964.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="4976.5625" y2="4972.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="4976.5625" y2="4980.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1955" y1="4976.5625" y2="4976.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="4990.5625" y2="4986.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1109" x2="1119" y1="4990.5625" y2="4994.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1531" y1="4990.5625" y2="4990.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="5004.5625" y2="5000.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="5004.5625" y2="5008.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="5004.5625" y2="5004.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="5018.5625" y2="5014.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="5018.5625" y2="5022.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="5018.5625" y2="5018.5625"/><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="5065.5625"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="5081.6294">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="5065.5625"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="5081.6294">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="5065.5625"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="5081.6294">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="5065.5625"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="5081.6294">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="5065.5625"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="5081.6294">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="5065.5625"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="5081.6294">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="5065.5625"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="5081.6294">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="5065.5625"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="5081.6294">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="5065.5625"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="5081.6294">legion</text><path d="M29,5125.6953 L98,5125.6953 L98,5132.8281 L88,5142.8281 L29,5142.8281 L29,5125.6953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="778.25" style="stroke:#000000;stroke-width:1.5;" width="2354" x="29" y="5125.6953"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="44" y="5138.7622">fwd</text><rect fill="#F0F6FF" height="98" style="stroke:#181818;stroke-width:0.5;" width="2317" x="39" y="5147.8281"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="1073.5" y="5163.895">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="1073.5" y="5179.0278">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="248" x="1073.5" y="5194.1606">42&#160;&#160;&#160;&#160;&#160;pred&#160;=&#160;compiled_model(X)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="240" x="1073.5" y="5209.2935">43&#160;&#160;&#160;&#160;&#160;loss&#160;=&#160;loss_fn(pred,&#160;y)</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="1073.5" y="5224.4263">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="1073.5" y="5239.5591">&#160;</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="5272.7578" y2="5268.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="5272.7578" y2="5276.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="5272.7578" y2="5272.7578"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="224" x="71" y="5267.6919">pred&#160;=&#160;compiled_model(batch)</text><path d="M347,5287.7578 L416,5287.7578 L416,5294.8906 L406,5304.8906 L347,5304.8906 L347,5287.7578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="258.3281" style="stroke:#000000;stroke-width:1.5;" width="814" x="347" y="5287.7578"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="362" y="5300.8247">opt</text><text fill="#000000" font-family="Courier" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="431" y="5299.9683">[if&#160;first&#160;iteration]</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="5386.5547" y2="5382.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="5386.5547" y2="5390.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="5386.5547" y2="5386.5547"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="439" y="5320.9575">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="439" y="5336.0903">flexflow_start_training(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="288" x="455" y="5351.2231">flexflow_model_compilation_result_t,</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="320" x="455" y="5366.356">flexflow_model_compilation_result_t&#160;*out</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="439" y="5381.4888">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="5423.5547" y2="5419.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="5423.5547" y2="5427.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="5423.5547" y2="5423.5547"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="449" y="5436.6216">typedef&#160;struct&#160;{</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216" x="465" y="5451.7544">ModelTrainingInstance&#160;*ptr;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="296" x="449" y="5466.8872">}&#160;flexflow_model_training_instance_t;</text><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="474" y1="5525.0859" y2="5525.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="474" x2="474" y1="5525.0859" y2="5538.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="474" y1="5538.0859" y2="5538.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="5538.0859" y2="5534.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="5538.0859" y2="5542.0859"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="439" y="5520.02">model.training_instance&#160;=&#160;...</text><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="5557.0859" y2="5553.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="5557.0859" y2="5561.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="5557.0859" y2="5557.0859"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="81" y="5570.1528">pred:&#160;TensorFuture</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="5628.3516" y2="5624.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="5628.3516" y2="5632.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="5628.3516" y2="5628.3516"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216" x="71" y="5623.2856">loss&#160;=&#160;loss_fn(pred,&#160;label)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="5702.8828" y2="5698.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="5702.8828" y2="5706.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="5702.8828" y2="5702.8828"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="439" y="5652.4185">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="328" x="439" y="5667.5513">flexflow_model_training_instance_forward(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="455" y="5682.6841">flexflow_model_training_instance_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="439" y="5697.8169">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="5732.0156" y2="5728.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="5732.0156" y2="5736.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1531" y1="5732.0156" y2="5732.0156"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312" x="1115" y="5726.9497">forward(ModelTrainingInstance&#160;const&#160;&amp;);</text><path d="M1463,5747.0156 L1540,5747.0156 L1540,5754.1484 L1530,5764.1484 L1463,5764.1484 L1463,5747.0156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="149.9297" style="stroke:#000000;stroke-width:1.5;" width="910" x="1463" y="5747.0156"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="1478" y="5760.0825">loop</text><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="5785.2813" y2="5781.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="5785.2813" y2="5789.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1955" y1="5785.2813" y2="5785.2813"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="1539" y="5780.2153">execute(OpTaskInvocation&#160;const&#160;&amp;);</text><line style="stroke:#181818;stroke-width:1.0;" x1="2330" x2="2320" y1="5859.8125" y2="5855.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="2330" x2="2320" y1="5859.8125" y2="5863.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1956" x2="2331" y1="5859.8125" y2="5859.8125"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1963" y="5809.3481">IndexLauncher&#160;launcher;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1963" y="5824.481">...</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="352" x="1963" y="5839.6138">runtime-&gt;execute_index_space(ctx,&#160;launcher);</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="1963" y="5854.7466">&#160;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="5871.8125" y2="5867.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="5871.8125" y2="5875.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="2331" y1="5871.8125" y2="5871.8125"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1549" y="5884.8794">TaskReturnAccessor</text><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1574" y1="5947.2109" y2="5947.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1574" x2="1574" y1="5947.2109" y2="5960.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1574" y1="5960.2109" y2="5960.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="5960.2109" y2="5956.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="5960.2109" y2="5964.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="256" x="1539" y="5927.0122">TaskReturnAcessor&#160;ret_acc&#160;=&#160;...;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="1539" y="5942.145">ret_acc.wait();</text><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="5972.2109" y2="5968.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="443" y1="5972.2109" y2="5976.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="5972.2109" y2="5972.2109"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136" x="449" y="5985.2778">flexflow_tensor_t</text><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="6001.3438" y2="5997.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="65" x2="75" y1="6001.3438" y2="6005.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="6001.3438" y2="6001.3438"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="81" y="6014.4106">loss:&#160;LossTensor</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="6063.4766"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="6079.5435">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="6063.4766"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="6079.5435">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="6063.4766"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="6079.5435">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="6063.4766"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="6079.5435">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="6063.4766"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="6079.5435">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="6063.4766"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="6079.5435">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="6063.4766"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="6079.5435">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="6063.4766"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="6079.5435">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="6063.4766"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="6079.5435">legion</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="2328" x="38" y="6116.6094"/><path d="M38,6116.6094 L107,6116.6094 L107,6123.6094 L97,6133.6094 L38,6133.6094 L38,6116.6094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="51" y="6130.6763">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="238" x="1083" y="6148.748">[optional]&#160;reading&#160;tensor&#160;elements</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="2328" x="38" y="6160.7109"/><path d="M38,6160.7109 L107,6160.7109 L107,6167.7109 L97,6177.7109 L38,6177.7109 L38,6160.7109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="51" y="6174.7778">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="259" x="1072.5" y="6192.8496">[optional]&#160;writing&#160;to&#160;tensor&#160;elements</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="6234.8125"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="6250.8794">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="6234.8125"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="6250.8794">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="6234.8125"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="6250.8794">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="6234.8125"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="6250.8794">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="6234.8125"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="6250.8794">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="6234.8125"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="6250.8794">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="6234.8125"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="6250.8794">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="6234.8125"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="6250.8794">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="6234.8125"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="6250.8794">legion</text><path d="M29,6294.9453 L98,6294.9453 L98,6302.0781 L88,6312.0781 L29,6312.0781 L29,6294.9453 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="464.7891" style="stroke:#000000;stroke-width:1.5;" width="2354" x="29" y="6294.9453"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="44" y="6308.0122">bwd</text><rect fill="#F0F6FF" height="83" style="stroke:#181818;stroke-width:0.5;" width="2317" x="39" y="6317.0781"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="1109.5" y="6333.145">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="1109.5" y="6348.2778">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="176" x="1109.5" y="6363.4106">44&#160;&#160;&#160;&#160;&#160;loss.backward()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="1109.5" y="6378.5435">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="1109.5" y="6393.6763">&#160;</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="6426.875" y2="6422.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="6426.875" y2="6430.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="6426.875" y2="6426.875"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="71" y="6421.8091">loss.backward()</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="6501.4063" y2="6497.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="6501.4063" y2="6505.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="6501.4063" y2="6501.4063"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="439" y="6450.9419">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="336" x="439" y="6466.0747">flexflow_model_training_instance_backward(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="455" y="6481.2075">flexflow_model_training_instance_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="439" y="6496.3403">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="6530.5391" y2="6526.5391"/><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="6530.5391" y2="6534.5391"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1531" y1="6530.5391" y2="6530.5391"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="320" x="1115" y="6525.4731">backward(ModelTrainingInstance&#160;const&#160;&amp;);</text><path d="M1463,6545.5391 L1540,6545.5391 L1540,6552.6719 L1530,6562.6719 L1463,6562.6719 L1463,6545.5391 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="149.9297" style="stroke:#000000;stroke-width:1.5;" width="910" x="1463" y="6545.5391"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="1478" y="6558.606">loop</text><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="6583.8047" y2="6579.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="6583.8047" y2="6587.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1955" y1="6583.8047" y2="6583.8047"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="1539" y="6578.7388">execute(OpTaskInvocation&#160;const&#160;&amp;);</text><line style="stroke:#181818;stroke-width:1.0;" x1="2330" x2="2320" y1="6658.3359" y2="6654.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="2330" x2="2320" y1="6658.3359" y2="6662.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="1956" x2="2331" y1="6658.3359" y2="6658.3359"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1963" y="6607.8716">IndexLauncher&#160;launcher;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1963" y="6623.0044">...</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="352" x="1963" y="6638.1372">runtime-&gt;execute_index_space(ctx,&#160;launcher);</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="1963" y="6653.27">&#160;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="6670.3359" y2="6666.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="6670.3359" y2="6674.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="2331" y1="6670.3359" y2="6670.3359"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1549" y="6683.4028">TaskReturnAccessor</text><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1574" y1="6738.7344" y2="6738.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1574" x2="1574" y1="6738.7344" y2="6751.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1574" y1="6751.7344" y2="6751.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="6751.7344" y2="6747.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="6751.7344" y2="6755.7344"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="256" x="1539" y="6718.5356">TaskReturnAcessor&#160;ret_acc&#160;=&#160;...;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="1539" y="6733.6685">ret_acc.wait();</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="6796.7344"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="6812.8013">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="6796.7344"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="6812.8013">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="6796.7344"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="6812.8013">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="6796.7344"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="6812.8013">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="6796.7344"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="6812.8013">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="6796.7344"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="6812.8013">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="6796.7344"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="6812.8013">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="6796.7344"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="6812.8013">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="6796.7344"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="6812.8013">legion</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="2328" x="38" y="6849.8672"/><path d="M38,6849.8672 L107,6849.8672 L107,6856.8672 L97,6866.8672 L38,6866.8672 L38,6849.8672 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="51" y="6863.9341">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="238" x="1083" y="6882.0059">[optional]&#160;reading&#160;tensor&#160;elements</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="2328" x="38" y="6893.9688"/><path d="M38,6893.9688 L107,6893.9688 L107,6900.9688 L97,6910.9688 L38,6910.9688 L38,6893.9688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="51" y="6908.0356">ref</text><text fill="#000000" font-family="Courier" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="259" x="1072.5" y="6926.1074">[optional]&#160;writing&#160;to&#160;tensor&#160;elements</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="6968.0703"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="6984.1372">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="6968.0703"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="6984.1372">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="6968.0703"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="6984.1372">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="6968.0703"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="6984.1372">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="6968.0703"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="6984.1372">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="6968.0703"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="6984.1372">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="6968.0703"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="6984.1372">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="6968.0703"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="6984.1372">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="6968.0703"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="6984.1372">legion</text><path d="M29,7028.2031 L122,7028.2031 L122,7035.3359 L112,7045.3359 L29,7045.3359 L29,7028.2031 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="592.1875" style="stroke:#000000;stroke-width:1.5;" width="2354" x="29" y="7028.2031"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="44" y="7041.27">update</text><rect fill="#F0F6FF" height="98" style="stroke:#181818;stroke-width:0.5;" width="2317" x="39" y="7050.3359"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="1085.5" y="7066.4028">&#160;</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="1085.5" y="7081.5356">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="184" x="1085.5" y="7096.6685">45&#160;&#160;&#160;&#160;&#160;optimizer.step()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="224" x="1085.5" y="7111.8013">46&#160;&#160;&#160;&#160;&#160;optimizer.zero_grad()</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="24" x="1085.5" y="7126.9341">...</text><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="8" x="1085.5" y="7142.0669">&#160;</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="7184.1328"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="7200.1997">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="7184.1328"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="7200.1997">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="7184.1328"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="7200.1997">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="7184.1328"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="7200.1997">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="7184.1328"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="7200.1997">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="7184.1328"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="7200.1997">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="7184.1328"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="7200.1997">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="7184.1328"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="7200.1997">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="7184.1328"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="7200.1997">legion</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="7258.3984" y2="7254.3984"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="7258.3984" y2="7262.3984"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="7258.3984" y2="7258.3984"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="71" y="7253.3325">optimizer.step()</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="7287.5313" y2="7283.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="7287.5313" y2="7291.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="7287.5313" y2="7287.5313"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="71" y="7282.4653">optimizer.zero_grad()</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="7362.0625" y2="7358.0625"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="7362.0625" y2="7366.0625"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="7362.0625" y2="7362.0625"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="439" y="7311.5981">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="320" x="439" y="7326.731">flexflow_model_training_instance_update(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="455" y="7341.8638">flexflow_model_training_instance_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="439" y="7356.9966">);</text><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="7391.1953" y2="7387.1953"/><line style="stroke:#181818;stroke-width:1.0;" x1="1530" x2="1520" y1="7391.1953" y2="7395.1953"/><line style="stroke:#181818;stroke-width:1.0;" x1="1108" x2="1531" y1="7391.1953" y2="7391.1953"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="304" x="1115" y="7386.1294">update(ModelTrainingInstance&#160;const&#160;&amp;);</text><path d="M1463,7406.1953 L1540,7406.1953 L1540,7413.3281 L1530,7423.3281 L1463,7423.3281 L1463,7406.1953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="149.9297" style="stroke:#000000;stroke-width:1.5;" width="910" x="1463" y="7406.1953"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="1478" y="7419.2622">loop</text><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="7444.4609" y2="7440.4609"/><line style="stroke:#181818;stroke-width:1.0;" x1="1954" x2="1944" y1="7444.4609" y2="7448.4609"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1955" y1="7444.4609" y2="7444.4609"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="296" x="1539" y="7439.395">execute(IndexTaskInvocation&#160;const&#160;&amp;);</text><line style="stroke:#181818;stroke-width:1.0;" x1="2330" x2="2320" y1="7518.9922" y2="7514.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="2330" x2="2320" y1="7518.9922" y2="7522.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="1956" x2="2331" y1="7518.9922" y2="7518.9922"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1963" y="7468.5278">IndexLauncher&#160;launcher;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1963" y="7483.6606">...</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="352" x="1963" y="7498.7935">runtime-&gt;execute_index_space(ctx,&#160;launcher);</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="1963" y="7513.9263">&#160;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="7530.9922" y2="7526.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="7530.9922" y2="7534.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="2331" y1="7530.9922" y2="7530.9922"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1549" y="7544.0591">TaskReturnAccessor</text><line style="stroke:#181818;stroke-width:1.0;" x1="1532" x2="1574" y1="7599.3906" y2="7599.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1574" x2="1574" y1="7599.3906" y2="7612.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1574" y1="7612.3906" y2="7612.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="7612.3906" y2="7608.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1533" x2="1543" y1="7612.3906" y2="7616.3906"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="256" x="1539" y="7579.1919">TaskReturnAcessor&#160;ret_acc&#160;=&#160;...;</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120" x="1539" y="7594.3247">ret_acc.wait();</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="40" x="44" y="7664.3906"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="32" x="48" y="7680.4575">User</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="144" x="360" y="7664.3906"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="136" x="364" y="7680.4575">./bindings/python</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="48" x="822" y="7664.3906"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="40" x="826" y="7680.4575">torch</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1068" y="7664.3906"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1072" y="7680.4575">./lib/ffi</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="80" x="1380" y="7664.3906"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="72" x="1384" y="7680.4575">./lib/pcg</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="112" x="1476" y="7664.3906"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="104" x="1480" y="7680.4575">./lib/runtime</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1760" y="7664.3906"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1764" y="7680.4575">./lib/compiler</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="120" x="1896" y="7664.3906"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="112" x="1900" y="7680.4575">RuntimeBacking</text><rect fill="#FFFFFF" height="23" style="stroke:#181818;stroke-width:0.5;" width="56" x="2304" y="7664.3906"/><text fill="#000000" font-family="Courier" font-size="13" lengthAdjust="spacing" textLength="48" x="2308" y="7680.4575">legion</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2413" x="0" y="7738.0898"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2413" y1="7738.0898" y2="7738.0898"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2413" y1="7741.0898" y2="7741.0898"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="134" x="1139.5" y="7727.5234"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="1145.5" y="7743.5903">Training&#160;Stops</text><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="7781.7891" y2="7777.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="430" x2="420" y1="7781.7891" y2="7785.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="64" x2="431" y1="7781.7891" y2="7781.7891"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="71" y="7776.7231">&lt;compiled_model&#160;goes&#160;out&#160;of&#160;scope&gt;</text><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="7856.3203" y2="7852.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="1106" x2="1096" y1="7856.3203" y2="7860.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="1107" y1="7856.3203" y2="7856.3203"/><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="439" y="7805.856">flexflow_error_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="439" y="7820.9888">flexflow_stop_training(</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272" x="455" y="7836.1216">flexflow_model_training_instance_t</text><text fill="#000000" font-family="Courier" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="439" y="7851.2544">);</text><!--SRC=[xLbxJzjA5l_VdsBwsEAm8K1uDYsi2hgWIhIBAAokr29hiCU9RntRQuyBBEL-zZrdpemViPs4zjwLThMfIkmvZpcFtvmvCv6130LpdDNLyrYAI0OyPEVtbt7gJjXbojqW6hFtaHIfprsnkkeublNiPPw9b1smvrVm_HpUativYICS6QpV1947Gjaw3I9PAcr0LGyuuli1SOV1pJgyA2Nkk1o35nnBSx1eAifnFO0qDvucGKY64D6CL2IFkFiLNG2UYze8yeHY793PzAIiuAaCt23XaJmwFOx3MEb_SQ8-DAqdAkCR9xiuRcMW56Jvb7d2vtaeJ-98VkHW-t6Sfu58spa-oNi8_qqSUXKwJzFujfEQYYo9eqny45d6n-98XF7jEvHWCir5XJ4J_yn5v1h6Ts4mZbWeVDd2So5yaUB3SboTnbN31u4Uft4UUHGkZ1NyiwmA3xjYF6FF5Q2UrmZdH30Wgf8kYQJ1LAMS44K1gZf-gfKXgAhZ5pHUWAfAEoPQYQagyQWcM42god96B0PPrZC_Zro9U7iv5j89l3kx2hQUnTYpm6UrGNPmO8A3TE18XSpJY6qWjmWpqIwXerQNsPmlG-6iYmpdYs2Swm9R2-o21DG5jkSBcCpKXNRc2nKfgqljBZMLoMLTTc- -h4voNMPVoK0nz2tyCka792Hfx0elJmLxcOefr4kdeZ6pNsOINWzqulli9KWVr2Rv_lqxAYT6X1BKeX9LQbJX2IKRP1ZhiRyI79GxfPQt1so3lNh52hb3ja5EfH7i3Yp-1kNsYhKKoH5JrfOkjohVd56-IShNAzhFExGJf1Ve7yxe7pRrNtReL_1Ve7vhHlrMK_r9XtfOAWkKRyyetsugF-sAZJjUe7ndHlbEK_b5XtAzBXPCi3ipmMvpWkEE2SnoNJ33timCUyqPZkQxe9VsWddsP-RPRyvprZ4FhT2gVboe-5AiU0i-f8cxQPnbhEmdBEkNEpvDO4_De6Dm1KCAixd74oayvgVnb7t-F94ooKRhs5qXOWTnEbwNEJn3uvQjtu05KIJIzHkU1Mws7YVWUF0lZeN7CMo3YPo6J4u4qqgOeLnVzomBLcamJU9KCZyKTpvq5mFYWlrChv9XEySWYf0fWX1iCGiGxOOSNFmeyfI77uMyZTElTXGDFiHU7ehUo09SCko6sE-E4qI1T1mx4w6Fb5qCEiloHAHsJK6VAPP1AG89sYDk80pya4jePA7amKmdz88i-oLB64I2fqugmjo1tBjVYVcJwdAm0xOjzfhH1yRF5Bizt5yTxlVPpkQmrxSsDqhwXJYxid5iio43p8N4i4LYgrrYSmE9suhKipPtr8ErIJ71UFbnUijJJqMhp-uWO9jxMXKM-seWx3lGiA-9OJmEP6Ou6d5GlCPplOsHY3NSODPmKqqkuyG9nJSHEf9dNssOV8Y-JG6k8QYkfxjd3G4BG_J5uvA7CVTKopuO3ApXZZL4ds0HIZfgE5FXJdWKP5FSM5Uo-odqbu7h85cim4JafIuPdcFcLDy3FMnRG-Cl3yS0R3cP7i1yVMjeVDFhGgGuRcrjw4XlOGP5s6cFTn_nQGnsR0tRxQ1bKDYnPVAhw7rhQrk_tq2mSLTVCGje1OWx5UEWmJ_m0bU2Zbt6shtPsYieDN-0Olm7brxhXsr8u3Rw1zY1-QKxWGBNP_QlVNRVOq74H9HFHSgbiCj4GMwtoTKaXHfqCEEn_IletTB8oX1N-ENuaOtigDZQtYx80_HQmHQ6T-fs3p8f4XpVdHc7_x4pJhaI8eUjRN8FqcJyO7-1DRE1ETe0YryNQC-oFdFp5CuiKXit2AIOmjfZDic2qzWCzTWg77eYT6Z7BEqa3I9f-yzHRCGUrDVXdl_8FZzedQF37Uzn_I43IzNZDNHd5kILOOM7Id-rTdXuFffVJR-4yslfb_1B-FiBE6VX4Uy_jWzy2HVKxYzXU-N6yMNhjkRjhjeLXiKrcvYxAdQ5ggjlax-irajpOwKcaZQM_hRMQAEYfK8RqkBwR3XhrHanqbgPaRkhBbkjXmyOvo60yKw35pKiABTaKhquqLYjBE4GjXVi71HVZXIE2Rl-dUadwWKVtQgFU0nZKnkobJ4G5z1ygJHhbmSc0MzrCMSGwonE3vKHbygxMUsZmgB1QSgJ2Q4T-LC8hpwWMAsbdmRK2hDdrFRO2qYeO3TuLOFYK29C8Av6JMqZTgpVF-2hXGTFHdiFI5qf9rlpKjz-A0UqzT1poxPJ9ghOSWp4sZBQabCD_KfK5Vhr38vfxvNQyRGzmagxeFONoaEIIwYuPq4cFnFtfShSjKR_sk5CW9wQd_5qNae0GVFpeHt5r2rWL5gxrXbUZYLLkzXdZ5pDqFPmzHeXkBQKrtzRMuFuit4tZib5u66-NyHcPkl1fUduTmqOapoPtIv27XZvHTRdKdcfIDSMmQirMCMDLh-uHDBiopXCBf-CwfZKasDlaKmSDnNO-G2awRYd1V7yfXzFTDWOa_U9G3SpcUQkP0zcPSowT9G78JQxgubCtn3JupmRReZVaM-ivlIBNU2Uvq3znqs5_AWOVZgQO-1eLCYqpNnAC-D6J0xJOcGFsCEpnpVB1qWBjiU3YhDo_gakUo0gdkfpAJJ7QR9uniE6oJ-JBjpSbpJznfXUoFnXbbSluFhir3Bd2YpyJ4Xte4VAtbOllxThQ-TKBiajIEkeORYbHKbAsqfbfDgOKl6eZjYbugRMZYAuk81KxeUjee8iSi4oEKNW5d4Kq9H366jZBSMbjY7FOPJz6PPYissIAjk4K-pKJJPLuclCgSXowF1MurpPJI12W5m0wbGSZqlk2s8sTcWNPgC3qOiooLxfoTyPSuxZo0_6XbhETW6p7SDidw2zTIS_DCS7xawWFVwK23Vm0vS0L6SvZZFvImPAEUmDJpLHe_HOnqMNifh1kgwTSsYhGufQpM3Og7IPeyNuWIT9sOOwKthLBAJvKnpcofDCFxmfNVa73tEHWQMPTBwfPqLyB29wKjhPaSQ7pj3E8F7D7-VQOu4lt1pQjuOESukDuf5rmLXlbZfRbN9KDcN5Uguqr5YBMfbPUmkte8VB19wQTT7IBVgvEOSulsNgH-RwH0EUAOAjYX09t08WOHd0YN35C0-GPwNFLcvNUdWVuBSq_WCldoQstojhbBAPJFD4tRZvBUd10Vxe3-TpoEKdl1M7i-Z1d1jhl3tx_wNIdt-fX76kN2o5SPpW5IKb2jywTpw52l0S3aZSAvSe4w6OmcIPtiWrOl57GcAezJ6LBkB2l635EQg-rDZEHnK5LwFoW3NVo5keoSh8UBwTsH9siZP3ZsPT-5chzMderbkqIduEyJC0A4FHhb31KBUK65T0jH-aiCC1K5DJfSguDVkPOeH-6pDOiskTJdTHxY_9fxkGraQM4jAsOQZAREhKUzYuUUGAiriypivhR7S2pTbzm09aKKLjoEXVB6gDB8444s3QxPDSgj_uQgefJws93VcD27kbjhcPwFB6N7ErXBp5zJBOj4gCT7jCTLjaH5IbgQug5OyxuUPGuF-UNFBiw_leMrplnihauk8x6xsFF75tnlF8dS1n8zGFa3brdwH_grqxr6h1T61tiWIl-bnvroyaUc_KdHz-pfGhEFs5kXPzvxeYCyK1yrN9saM3Lx7YXQh3NPSI3Qhr- -2M1zAknknyr76C8ZnGOJ-3l-KHR64LAMwlhlhiJ2dxJ5ToFBoUKxcrthdISqlgakNjPd5vQz-H6sMhN0nLDkidu5-eUHh-2Vs5y1BmBy1leByiyFyasCy1lKxhJq3zlnsnUGBzfbW4sX_f5nkGxZQ5mDvGtqAfJl0pYu7S_g6be4MVlX3CCb00_nzR2QJW2KUcEA4J4oNuxSpXSXp30Huw7XP3G-F2IU_GifRemE9aRWFMcLhhtm00]--></g></svg>